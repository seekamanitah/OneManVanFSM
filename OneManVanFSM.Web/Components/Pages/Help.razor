@page "/help"
@rendermode InteractiveServer
@inject NavigationManager Nav

<PageTitle>Help & Support - OneManVanFSM</PageTitle>

<div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="mb-0"><i class="bi bi-question-circle-fill me-2"></i>Help & Support</h4>
    <small class="text-muted">Your built-in knowledge base for every feature</small>
</div>

@* Global search across all tabs *@
<div class="input-group mb-3 shadow-sm">
    <span class="input-group-text bg-white border-end-0"><i class="bi bi-search text-muted"></i></span>
    <input type="text" class="form-control border-start-0" placeholder="Search all help topics, workflows, FAQs, and tips..."
           @bind="_search" @bind:event="oninput" />
    @if (!string.IsNullOrWhiteSpace(_search))
    {
        <button class="btn btn-outline-secondary" @onclick='() => _search = ""'><i class="bi bi-x-lg"></i></button>
    }
</div>
@if (!string.IsNullOrWhiteSpace(_search))
{
    <div class="mb-3">
        <span class="badge bg-secondary">@TotalSearchHits result(s) for "@_search"</span>
    </div>
}

<ul class="nav nav-pills mb-3">
    <li class="nav-item">
        <a class="nav-link @(_tab == "start" ? "active" : "")" style="@(_tab == "start" ? "background:#1a2332;color:#fff;" : "color:#1a2332;")" href="javascript:void(0)" @onclick='() => _tab = "start"'>
            <i class="bi bi-rocket-takeoff me-1"></i>Getting Started
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link @(_tab == "pages" ? "active" : "")" style="@(_tab == "pages" ? "background:#1a2332;color:#fff;" : "color:#1a2332;")" href="javascript:void(0)" @onclick='() => _tab = "pages"'>
            <i class="bi bi-book me-1"></i>All Pages
            @if (!string.IsNullOrWhiteSpace(_search) && FilteredPages.Count > 0)
            {
                <span class="badge bg-light text-dark ms-1">@FilteredPages.Count</span>
            }
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link @(_tab == "workflows" ? "active" : "")" style="@(_tab == "workflows" ? "background:#1a2332;color:#fff;" : "color:#1a2332;")" href="javascript:void(0)" @onclick='() => _tab = "workflows"'>
            <i class="bi bi-diagram-3 me-1"></i>Workflows
            @if (!string.IsNullOrWhiteSpace(_search) && FilteredWorkflows.Length > 0)
            {
                <span class="badge bg-light text-dark ms-1">@FilteredWorkflows.Length</span>
            }
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link @(_tab == "faq" ? "active" : "")" style="@(_tab == "faq" ? "background:#1a2332;color:#fff;" : "color:#1a2332;")" href="javascript:void(0)" @onclick='() => _tab = "faq"'>
            <i class="bi bi-chat-dots me-1"></i>FAQ
            @if (!string.IsNullOrWhiteSpace(_search) && FilteredFaqs.Length > 0)
            {
                <span class="badge bg-light text-dark ms-1">@FilteredFaqs.Length</span>
            }
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link @(_tab == "tips" ? "active" : "")" style="@(_tab == "tips" ? "background:#1a2332;color:#fff;" : "color:#1a2332;")" href="javascript:void(0)" @onclick='() => _tab = "tips"'>
            <i class="bi bi-lightbulb me-1"></i>Tips & Tricks
            @if (!string.IsNullOrWhiteSpace(_search) && FilteredTips.Length > 0)
            {
                <span class="badge bg-light text-dark ms-1">@FilteredTips.Length</span>
            }
        </a>
    </li>
</ul>

@* ===================== GETTING STARTED ===================== *@
@if (_tab == "start")
{
    <div class="card border-0 shadow-sm mb-3">
        <div class="card-body">
            <h5><i class="bi bi-rocket-takeoff me-2 text-primary"></i>Welcome to OneManVanFSM</h5>
            <p class="text-muted">Follow these steps to get your business set up and running quickly.</p>
            <div class="row g-3 mt-1">
                @{ var idx = 0; }
                @foreach (var step in _gettingStarted)
                {
                    idx++;
                    <div class="col-md-6 col-lg-4">
                        <div class="card border-0 bg-light h-100">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-2">
                                    <span class="badge bg-primary rounded-circle me-2" style="width:28px;height:28px;line-height:20px;font-size:.85rem;">@idx</span>
                                    <h6 class="mb-0">@step.Title</h6>
                                </div>
                                <p class="text-muted small mb-2">@step.Description</p>
                                <button class="btn btn-sm btn-outline-primary" @onclick="@(() => Nav.NavigateTo(step.Route))">
                                    <i class="bi bi-box-arrow-up-right me-1"></i>Go to @step.Title
                                </button>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>

    <div class="card border-0 shadow-sm mb-3">
        <div class="card-body">
            <h5><i class="bi bi-diagram-3 me-2 text-success"></i>How Data Flows</h5>
            <p class="text-muted small">Understanding how entities connect is key to efficient operation.</p>
            <div class="d-flex flex-wrap align-items-center gap-2 mt-2">
                <span class="badge bg-light text-dark border px-3 py-2">Customers</span>
                <i class="bi bi-arrow-right text-muted"></i>
                <span class="badge bg-light text-dark border px-3 py-2">Sites</span>
                <i class="bi bi-arrow-right text-muted"></i>
                <span class="badge bg-light text-dark border px-3 py-2">Assets</span>
                <i class="bi bi-arrow-right text-muted"></i>
                <span class="badge bg-light text-dark border px-3 py-2">Jobs</span>
                <i class="bi bi-arrow-right text-muted"></i>
                <span class="badge bg-light text-dark border px-3 py-2">Invoices</span>
                <i class="bi bi-arrow-right text-muted"></i>
                <span class="badge bg-light text-dark border px-3 py-2">Payments</span>
            </div>
            <div class="d-flex flex-wrap align-items-center gap-2 mt-2">
                <span class="badge bg-light text-dark border px-3 py-2">Products</span>
                <i class="bi bi-arrow-right text-muted"></i>
                <span class="badge bg-light text-dark border px-3 py-2">Material Lists</span>
                <i class="bi bi-arrow-right text-muted"></i>
                <span class="badge bg-light text-dark border px-3 py-2">Estimates</span>
                <i class="bi bi-arrow-right text-muted"></i>
                <span class="badge bg-light text-dark border px-3 py-2">Jobs</span>
                <i class="bi bi-arrow-right text-muted"></i>
                <span class="badge bg-light text-dark border px-3 py-2">Inventory Deduction</span>
            </div>
            <div class="d-flex flex-wrap align-items-center gap-2 mt-2">
                <span class="badge bg-light text-dark border px-3 py-2">Agreements</span>
                <i class="bi bi-arrow-right text-muted"></i>
                <span class="badge bg-light text-dark border px-3 py-2">Scheduled Visits</span>
                <i class="bi bi-arrow-right text-muted"></i>
                <span class="badge bg-light text-dark border px-3 py-2">Service History</span>
                <i class="bi bi-arrow-right text-muted"></i>
                <span class="badge bg-light text-dark border px-3 py-2">Warranty Claims</span>
            </div>
        </div>
    </div>

    <div class="card border-0 shadow-sm">
        <div class="card-body">
            <h5><i class="bi bi-signpost-split me-2 text-info"></i>Quick Navigation Reference</h5>
            <div class="row g-2 mt-1">
                @foreach (var p in _helpPages)
                {
                    <div class="col-6 col-md-3">
                        <button class="btn btn-outline-secondary btn-sm w-100 text-start" @onclick="@(() => Nav.NavigateTo(p.Route))">
                            <i class="bi @p.Icon me-1 text-primary"></i>@p.Key
                        </button>
                    </div>
                }
            </div>
        </div>
    </div>
}

@* ===================== ALL PAGES ===================== *@
else if (_tab == "pages")
{
    @if (FilteredPages.Count == 0 && !string.IsNullOrWhiteSpace(_search))
    {
        <div class="text-center py-4 text-muted">
            <i class="bi bi-emoji-frown" style="font-size:2rem;"></i>
            <p class="mt-2 mb-0">No page guides match "<strong>@_search</strong>". Try different keywords.</p>
        </div>
    }
    else
    {
        <div class="accordion" id="helpAccordion">
            @foreach (var pg in FilteredPages)
            {
                var collapseId = "collapse-" + pg.Key.Replace(" ", "").Replace("/", "");
                <div class="accordion-item border-0 shadow-sm mb-2">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#@collapseId">
                            <i class="bi @pg.Icon me-2 text-primary"></i><strong>@pg.Key</strong>
                            <span class="badge bg-light text-muted ms-2 fw-normal small">@pg.Route</span>
                        </button>
                    </h2>
                    <div id="@collapseId" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
                        <div class="accordion-body">
                            <div class="row">
                                <div class="col-md-8">
                                    <h6 class="text-primary"><i class="bi bi-info-circle me-1"></i>Purpose</h6>
                                    <p>@pg.Purpose</p>

                                    <h6 class="text-success"><i class="bi bi-hand-index me-1"></i>How to Use</h6>
                                    <p>@pg.HowTo</p>

                                    <h6 class="text-warning"><i class="bi bi-link-45deg me-1"></i>Data Connections</h6>
                                    <p class="mb-2">@pg.Connections</p>

                                    @if (pg.ProTips.Length > 0)
                                    {
                                        <h6 class="text-info"><i class="bi bi-star me-1"></i>Pro Tips</h6>
                                        <ul class="small mb-0">
                                            @foreach (var tip in pg.ProTips)
                                            {
                                                <li>@tip</li>
                                            }
                                        </ul>
                                    }
                                </div>
                                <div class="col-md-4 d-flex flex-column gap-2 mt-3 mt-md-0">
                                    <button class="btn btn-primary btn-sm" @onclick="@(() => Nav.NavigateTo(pg.Route))">
                                        <i class="bi bi-box-arrow-up-right me-1"></i>Open @pg.Key
                                    </button>
                                    @foreach (var link in pg.RelatedPages)
                                    {
                                        <button class="btn btn-outline-secondary btn-sm" @onclick="@(() => Nav.NavigateTo(link.Route))">
                                            <i class="bi @link.Icon me-1"></i>@link.Label
                                        </button>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
}

@* ===================== WORKFLOWS ===================== *@
else if (_tab == "workflows")
{
    @if (FilteredWorkflows.Length == 0 && !string.IsNullOrWhiteSpace(_search))
    {
        <div class="text-center py-4 text-muted">
            <i class="bi bi-emoji-frown" style="font-size:2rem;"></i>
            <p class="mt-2 mb-0">No workflows match "<strong>@_search</strong>".</p>
        </div>
    }
    else
    {
        <div class="row g-3">
            @foreach (var wf in FilteredWorkflows)
            {
                <div class="col-md-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-header bg-white d-flex justify-content-between align-items-center">
                            <h6 class="mb-0"><i class="bi @wf.Icon me-2 text-primary"></i>@wf.Title</h6>
                            <span class="badge bg-light text-muted">@wf.Steps.Length steps</span>
                        </div>
                        <div class="card-body">
                            <p class="text-muted small mb-2">@wf.Description</p>
                            <ol class="small mb-3">
                                @foreach (var step in wf.Steps)
                                {
                                    <li class="mb-1">@step</li>
                                }
                            </ol>
                            @if (wf.RelatedRoutes.Length > 0)
                            {
                                <div class="d-flex flex-wrap gap-1">
                                    @foreach (var r in wf.RelatedRoutes)
                                    {
                                        <button class="btn btn-outline-primary btn-sm" @onclick="@(() => Nav.NavigateTo(r.Route))">
                                            <i class="bi @r.Icon me-1"></i>@r.Label
                                        </button>
                                    }
                                </div>
                            }
                        </div>
                    </div>
                </div>
            }
        </div>
    }
}

@* ===================== FAQ ===================== *@
else if (_tab == "faq")
{
    @if (FilteredFaqs.Length == 0 && !string.IsNullOrWhiteSpace(_search))
    {
        <div class="text-center py-4 text-muted">
            <i class="bi bi-emoji-frown" style="font-size:2rem;"></i>
            <p class="mt-2 mb-0">No FAQs match "<strong>@_search</strong>".</p>
        </div>
    }
    else
    {
        <div class="accordion" id="faqAccordion">
            @{ var faqIdx = 0; }
            @foreach (var faq in FilteredFaqs)
            {
                var faqId = "faq-" + faqIdx;
                faqIdx++;
                <div class="accordion-item border-0 shadow-sm mb-2">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#@faqId">
                            <i class="bi bi-question-circle me-2 text-info"></i>@faq.Question
                            <span class="badge bg-light text-muted ms-auto me-2 small">@faq.Category</span>
                        </button>
                    </h2>
                    <div id="@faqId" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            <p class="mb-2">@faq.Answer</p>
                            @if (!string.IsNullOrEmpty(faq.RelatedRoute))
                            {
                                <button class="btn btn-sm btn-outline-primary" @onclick="@(() => Nav.NavigateTo(faq.RelatedRoute))">
                                    <i class="bi bi-box-arrow-up-right me-1"></i>Try It
                                </button>
                            }
                        </div>
                    </div>
                </div>
            }
        </div>
    }
}

@* ===================== TIPS ===================== *@
else
{
    @if (FilteredTips.Length == 0 && !string.IsNullOrWhiteSpace(_search))
    {
        <div class="text-center py-4 text-muted">
            <i class="bi bi-emoji-frown" style="font-size:2rem;"></i>
            <p class="mt-2 mb-0">No tips match "<strong>@_search</strong>".</p>
        </div>
    }
    else
    {
        var categories = FilteredTips.Select(t => t.Category).Distinct().ToArray();
        @foreach (var cat in categories)
        {
            <h6 class="text-muted mt-3 mb-2"><i class="bi @GetTipCategoryIcon(cat) me-1"></i>@cat</h6>
            <div class="row g-3 mb-2">
                @foreach (var tip in FilteredTips.Where(t => t.Category == cat))
                {
                    <div class="col-md-4">
                        <div class="card border-0 shadow-sm h-100">
                            <div class="card-body">
                                <div class="d-flex align-items-start mb-1">
                                    <i class="bi bi-lightbulb text-warning me-2 mt-1"></i>
                                    <h6 class="mb-0">@tip.Title</h6>
                                </div>
                                <p class="text-muted small mb-2">@tip.Description</p>
                                @if (!string.IsNullOrEmpty(tip.RelatedRoute))
                                {
                                    <button class="btn btn-sm btn-outline-primary" @onclick="@(() => Nav.NavigateTo(tip.RelatedRoute))">
                                        <i class="bi bi-box-arrow-up-right me-1"></i>Try It
                                    </button>
                                }
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
    }
}

@code {
    private string _tab = "start";
    private string _search = "";

    private bool MatchSearch(params string[] fields) =>
        string.IsNullOrWhiteSpace(_search) ||
        fields.Any(f => f.Contains(_search, StringComparison.OrdinalIgnoreCase));

    private List<HelpPage> FilteredPages => string.IsNullOrWhiteSpace(_search) ? _helpPages
        : _helpPages.Where(p => MatchSearch(p.Key, p.Purpose, p.HowTo, p.Connections, string.Join(" ", p.ProTips))).ToList();

    private WorkflowGuide[] FilteredWorkflows => string.IsNullOrWhiteSpace(_search) ? _workflows
        : _workflows.Where(w => MatchSearch(w.Title, w.Description, string.Join(" ", w.Steps))).ToArray();

    private FaqItem[] FilteredFaqs => string.IsNullOrWhiteSpace(_search) ? _faqs
        : _faqs.Where(f => MatchSearch(f.Question, f.Answer, f.Category)).ToArray();

    private TipItem[] FilteredTips => string.IsNullOrWhiteSpace(_search) ? _tips
        : _tips.Where(t => MatchSearch(t.Title, t.Description, t.Category)).ToArray();

    private int TotalSearchHits => FilteredPages.Count + FilteredWorkflows.Length + FilteredFaqs.Length + FilteredTips.Length;

    private string GetTipCategoryIcon(string cat) => cat switch
    {
        "Efficiency" => "bi-lightning-charge",
        "Mobile" => "bi-phone",
        "Data Management" => "bi-database",
        "Scheduling" => "bi-calendar-check",
        "Financial" => "bi-currency-dollar",
        "Field Work" => "bi-tools",
        _ => "bi-lightbulb"
    };

    record RelatedLink(string Label, string Icon, string Route);
    record HelpPage(string Key, string Icon, string Route, string Purpose, string HowTo, string Connections, string[] ProTips, RelatedLink[] RelatedPages);
    record WorkflowGuide(string Title, string Icon, string Description, string[] Steps, RelatedLink[] RelatedRoutes);
    record FaqItem(string Question, string Answer, string Category, string? RelatedRoute = null);
    record TipItem(string Title, string Description, string Category, string? RelatedRoute = null);
    record GettingStartedStep(string Title, string Description, string Route);

    private GettingStartedStep[] _gettingStarted =
    [
        new("Settings", "Configure your company profile, user accounts, dropdown options, notification preferences, and default tax rates. This is the foundation — all dropdown menus, form defaults, and company branding pull from here.", "/settings"),
        new("Customers", "Add your clients with contact info, billing addresses, and customer type (Residential, Commercial, Property Management). Each customer can have multiple sites, contacts, and linked service agreements.", "/customers"),
        new("Companies", "Set up vendor, supplier, and subcontractor companies you work with. Companies can also represent commercial customers with multiple contacts and sites.", "/companies"),
        new("Sites", "Add property locations with addresses, zones, square footage, access notes (gate codes, parking instructions), and link them to customers. Site data auto-populates material lists and job forms.", "/sites"),
        new("Products", "Build your product catalog with equipment, parts, and materials — include part numbers, pricing, supplier info, and specs. Products are used in material lists, estimates, and inventory tracking.", "/products"),
        new("Employees", "Add your team members with roles (Owner, Admin, Tech, Dispatcher), certifications (EPA, NATE), territories, hourly rates, and emergency contacts. Employee data drives job assignment and time tracking.", "/employees"),
        new("Inventory", "Set up your stock tracking with locations, reorder points, and expiration dates. Link inventory items to products for automatic deduction when jobs are completed.", "/inventory"),
        new("Templates", "Create reusable blueprints for material lists, job checklists, and common equipment configurations. Templates save significant time when building estimates for recurring job types.", "/templates"),
        new("Jobs", "Create your first work order — assign technicians, schedule dates, link to customers/sites, and track through the full status workflow from New to Closed.", "/jobs"),
        new("Financials", "Set up your invoicing workflow — create invoices from completed jobs, record payments, and track expenses. Configure payment terms and tax rates in Settings first.", "/financials"),
    ];

    private List<HelpPage> _helpPages =
    [
        new("Dashboard", "bi-speedometer2", "/",
            "Your daily command center showing urgent concerns at a glance: unscheduled jobs, overdue invoices, low inventory, expiring service agreements, recent activity feed, and performance KPIs. Everything is clickable — tap any metric to navigate directly to the relevant page.",
            "Start your day here. Review the KPI cards for unscheduled jobs, overdue invoices, low inventory alerts, and expiring agreements. Each card is clickable and navigates to the filtered view. The activity feed at the bottom shows the latest changes across all modules. Charts display trends over time for revenue, job completion, and other key metrics. Use the date range filter to adjust the reporting period.",
            "Pulls real-time data from Jobs (unscheduled/in-progress counts), Financials (overdue invoices, revenue totals), Inventory (low stock alerts), Service Agreements (expiring contracts), and Calendar (upcoming events). Activity feed aggregates changes from all entity types.",
            ["Start every workday on the Dashboard to see what needs immediate attention.", "Unscheduled and overdue items are highlighted with urgency badges — click them to take action.", "The revenue chart helps identify seasonal trends in your business.", "Use the Dashboard to quickly spot if a tech has too many jobs assigned."],
            [new("Jobs", "bi-briefcase", "/jobs"), new("Financials", "bi-receipt", "/financials"), new("Inventory", "bi-boxes", "/inventory"), new("Calendar", "bi-calendar3", "/calendar")]),
        new("Customers", "bi-people-fill", "/customers",
            "Manage all your clients — residential homeowners, commercial businesses, and property management companies. Track contact information, billing addresses, customer type, and territorial assignments. Each customer can have multiple sites, contacts, estimates, jobs, invoices, and service agreements linked to them.",
            "Use the list view to browse, search, and filter customers by type (Residential, Commercial, Property Management), active status, and search terms. Click any customer to see the full detail view with linked sites, jobs, invoices, estimates, and agreements. From the detail view, you can quickly create a new job, estimate, or invoice for that customer. The edit form lets you manage contact details, billing address, and customer type. Use the bulk actions to archive, restore, or delete multiple customers at once.",
            "Customers are the top-level entity. Data flows down to Sites (where work happens), Jobs (what work is done), Estimates (proposed work and pricing), Invoices (billing), Service Agreements (recurring contracts), and Documents (attached files). When you select a customer on other forms (Jobs, Estimates, Invoices), their sites and contact info auto-populate.",
            ["Use the search bar to find customers by name, phone, email, or address.", "Territorial customers can have sites across multiple locations — use the Sites tab in the detail view.", "Set customer type accurately — it affects how data is presented throughout the app.", "Archive inactive customers instead of deleting to preserve historical data."],
            [new("Sites", "bi-geo-alt", "/sites"), new("Jobs", "bi-briefcase", "/jobs"), new("Estimates", "bi-calculator", "/estimates"), new("Financials", "bi-receipt", "/financials")]),
        new("Companies", "bi-building", "/companies",
            "Manage vendor, supplier, subcontractor, and partner companies. Companies represent business entities you work with — they can also serve as commercial customers. Track contacts, sites, jobs, invoices, and service agreements per company.",
            "Browse companies in the list view with filters for type (Customer, Vendor, Subcontractor, Partner) and active status. Click any company for the full detail view showing contacts, sites, recent jobs, outstanding invoices, and service agreements. Create new companies with the form — if you enter an address, a primary site is auto-created. Use bulk actions to manage multiple companies at once.",
            "Companies link to Contacts (people at the company), Sites (locations they own or manage), Jobs (work done for or with them), Invoices (billing), and Service Agreements (contracts). Company data can be selected on Jobs and Invoices to associate work with a specific business entity.",
            ["Use company type to distinguish between customers, vendors, and subcontractors.", "The primary contact is shown on list views for quick reference.", "Companies with an address automatically get a Primary Location site created.", "Use the active/inactive toggle to hide companies you no longer work with without losing data."],
            [new("Customers", "bi-people", "/customers"), new("Sites", "bi-geo-alt", "/sites"), new("Jobs", "bi-briefcase", "/jobs")]),
        new("Sites", "bi-geo-alt-fill", "/sites",
            "Manage property locations where work is performed. Sites belong to customers or companies and contain detailed property info: address, square footage, zone counts, property type, access instructions (gate codes, parking, entry points), and linked assets. Site data auto-populates material lists and job forms.",
            "Browse sites with search and filtering by customer, property type, and active status. The detail view shows the full property profile including linked assets, recent jobs, access notes, and a map link. When creating a site, fill in as much detail as possible — square footage and zone data directly feed into material list calculations for accurate bidding. Access instructions help technicians find and enter the property.",
            "Sites belong to Customers or Companies. They connect down to Assets (equipment installed at the site), Jobs (work performed at the site), Material Lists (items needed for the site), and Calendar events. When you select a site on a Job or Estimate form, the address and property details auto-populate.",
            ["Add detailed access instructions (gate codes, key locations, parking) so technicians can find and enter the site.", "Zone and square footage data helps generate accurate material estimates — especially for HVAC ductwork calculations.", "Link assets to sites to track what equipment is installed where.", "Use property type categorization to organize your sites effectively."],
            [new("Customers", "bi-people", "/customers"), new("Assets", "bi-cpu", "/assets"), new("Material Lists", "bi-list-check", "/materiallists"), new("Jobs", "bi-briefcase", "/jobs")]),
        new("Jobs", "bi-briefcase-fill", "/jobs",
            "The core work order system. Track jobs from creation to completion with the full status workflow: New → Scheduled → En Route → On Site → In Progress → Paused → Completed → Closed. Assign technicians, schedule dates, link customers/sites/assets, log time entries, track materials used, and generate invoices on completion.",
            "Create jobs directly or convert from approved estimates. Assign technicians by checking their certifications and availability in the Calendar. The detail view shows everything: customer/site info, assigned techs, time entries, linked material lists, assets, and status history. Update job status through the workflow — each status change can trigger notifications. When a job is completed, generate an invoice directly from the job with all materials and labor auto-populated. Use filters to focus on specific statuses, priorities, date ranges, or assigned technicians.",
            "Jobs connect to Customers (who the work is for), Sites (where), Employees (who does it), Calendar (when), Material Lists (what materials), Time Entries (labor hours), Assets (equipment worked on), Invoices (billing), Estimates (original bid), and Service History (maintenance records). This is the central hub where most data flows converge.",
            ["Use quick filters (status, priority, date range) to focus on what matters right now.", "Jobs created from estimates carry over material lists and customer data automatically — no re-entry.", "The status workflow drives notifications — techs are alerted on assignment, dispatchers see when techs arrive on site.", "Link material lists to jobs before dispatch so techs know what to bring.", "Time entries logged against jobs automatically feed into invoice line items."],
            [new("Calendar", "bi-calendar3", "/calendar"), new("Employees", "bi-person-badge", "/employees"), new("Financials", "bi-receipt", "/financials"), new("Material Lists", "bi-list-check", "/materiallists")]),
        new("Products", "bi-box-seam", "/products",
            "Your complete product catalog — equipment, parts, materials, and supplies with specifications, pricing, supplier tracking, and categorization. Products serve as the foundation for material lists, inventory tracking, and accurate bidding.",
            "Browse the catalog with search, category filters, and supplier filters. Each product has a detail view with specs, pricing history, supplier info, and usage tracking. When adding products, include part numbers, unit costs, and preferred suppliers for accurate purchasing. Products can be linked to inventory items for stock tracking and to material list line items for estimate building.",
            "Products feed into Material Lists (for bidding), Inventory (for stock tracking), Estimates (for pricing), and Assets (when installed equipment becomes a tracked asset). Supplier links help with reordering. Product pricing flows through to invoices when items are used on jobs.",
            ["Keep part numbers and pricing up to date for accurate estimates.", "Products linked to suppliers streamline reordering when inventory runs low.", "Use categories to organize products (Equipment, Parts, Materials, Supplies, Tools).", "Product specs (tonnage, SEER, model) transfer to assets when equipment is installed."],
            [new("Inventory", "bi-boxes", "/inventory"), new("Material Lists", "bi-list-check", "/materiallists"), new("Suppliers", "bi-truck", "/suppliers")]),
        new("Inventory", "bi-boxes", "/inventory",
            "Real-time stock tracking with locations, reorder points, expiration dates, and KPI dashboards. Monitor what you have, where it is, and when to reorder. The dashboard surfaces low-stock alerts and expiring items automatically.",
            "The KPI dashboard shows total items, total value, low-stock count, and expiring items at a glance. Browse inventory with search and category filters. Each item tracks quantity on hand, location (warehouse, truck, site), reorder point, and expiration date. Use batch adjustments for stocktaking. Set reorder points to get automatic alerts on the Dashboard when stock drops below threshold. The system can deduct inventory when materials are used on jobs.",
            "Inventory links to Products (what the item is), Material Lists (what's needed for jobs), Jobs (materials consumed), and Suppliers (where to reorder). Low-stock alerts appear on the Dashboard. Reorder thresholds trigger notifications if configured in Settings.",
            ["Set reorder thresholds to get notified before you run out of critical parts.", "Use batch adjustments for efficient stocktaking and cycle counts.", "Track inventory by location (warehouse vs. truck) to know where stock is.", "Expiration tracking prevents using outdated materials (refrigerant, sealants, etc.)."],
            [new("Products", "bi-box-seam", "/products"), new("Material Lists", "bi-list-check", "/materiallists"), new("Dashboard", "bi-speedometer2", "/")]),
        new("Estimates", "bi-calculator", "/estimates",
            "Create and manage customer bids with a complete status workflow: Draft → Sent → Approved → Rejected → Expired. Build estimates with material line items, labor costs, and markup. Convert approved estimates to jobs with a single click — all data transfers automatically.",
            "Create estimates linked to customers and sites. Build line items from your product catalog or enter custom items. Set pricing methods (itemized, flat rate, time & material), apply markup percentages, and add tax. The estimate detail view shows the full breakdown with totals. When a customer approves, convert to a job — materials, customer info, and site data all carry over. Track estimate status to follow up on pending bids. Use templates to speed up common estimate types.",
            "Estimates connect to Customers (who the bid is for), Sites (where), Material Lists (what's needed), Products (for pricing), Jobs (when converted), and Templates (for reusable structures). The conversion workflow eliminates re-entry — everything transfers to the new job.",
            ["Use the pricing summary to review margins before sending to the customer.", "Approved estimates convert to jobs with materials and customer data intact.", "Track estimate status to follow up on pending bids — don't let opportunities slip.", "Apply consistent markup using the percentage field rather than manually adjusting prices.", "Save common estimate structures as templates for recurring job types."],
            [new("Jobs", "bi-briefcase", "/jobs"), new("Material Lists", "bi-list-check", "/materiallists"), new("Customers", "bi-people", "/customers"), new("Templates", "bi-copy", "/templates")]),
        new("Assets", "bi-cpu", "/assets",
            "Track installed equipment with detailed specs: brand, model, serial number, tonnage, SEER rating, refrigerant type, warranty dates, and maintenance schedules. Monitor asset status (Active, Maintenance Needed, Retired, Decommissioned) and full service history.",
            "Browse assets with filters for status, type, customer, and site. The detail view shows complete specs, warranty information, linked service agreements, full service history, and maintenance schedule. Create assets when equipment is installed on jobs — product specs auto-populate. Track warranty expiration dates and set alerts to file claims before deadlines. Service history records every visit, repair, and maintenance action.",
            "Assets belong to Customers and Sites. They connect to Products (what it is), Jobs (work done on it), Service Agreements (coverage), Service History (maintenance/repair records), Documents (manuals, warranties), and Material Lists (parts needed for service). When a job involves an asset, the service history is automatically updated.",
            ["Track warranty expiration to avoid missed claims — set alerts in advance.", "Assets created from job completion automatically link the complete service history.", "Include serial numbers and model info for accurate warranty and parts lookups.", "Link warranty documents to assets for easy reference during service calls.", "Use the status field to flag equipment needing attention."],
            [new("Service History", "bi-wrench-adjustable", "/servicehistory"), new("Sites", "bi-geo-alt", "/sites"), new("Agreements", "bi-file-earmark-check", "/serviceagreements"), new("Documents", "bi-folder", "/documents")]),
        new("Employees", "bi-person-badge-fill", "/employees",
            "Complete team management: roles (Owner, Admin, Dispatcher, Technician, Manager), certifications (EPA 608, NATE, etc.), territories, hourly rates, emergency contacts, and time tracking. Employee data drives job assignment, certification-aware dispatching, and labor cost calculations.",
            "Add employees with their role, certifications, territory assignments, hourly rates, and contact information. The detail view shows assigned jobs, time entries, and certification expiration dates. When assigning technicians to jobs, check their certifications to ensure qualified dispatch. Time entries logged against jobs feed into invoice labor calculations. Use territory assignments to optimize dispatching by geographic area.",
            "Employees connect to Jobs (assigned work), Calendar (scheduled events), Time Entries (hours logged), and Financials (labor costs on invoices). Certification data drives qualified dispatching — the system helps ensure you send techs with the right credentials.",
            ["Keep certifications (EPA 608, NATE) up to date for compliance — expiration alerts help.", "Territory assignment helps with efficient dispatching and minimizing drive time.", "Hourly rates feed into invoice calculations — keep them current.", "Use roles to control what employees can see and do in the app.", "Emergency contact info is important for field safety."],
            [new("Jobs", "bi-briefcase", "/jobs"), new("Calendar", "bi-calendar3", "/calendar"), new("Financials", "bi-receipt", "/financials")]),
        new("Financials", "bi-receipt", "/financials",
            "Complete financial management: invoices, expenses, and payments with dashboard KPIs, aging reports, and revenue tracking. Generate invoices from completed jobs with auto-populated line items. Record partial and full payments. Track business expenses against jobs or as general overhead.",
            "The Financials hub has tabs for Invoices, Expenses, and Payments. Create invoices from completed jobs — materials and labor auto-populate from the job's time entries and material lists. Choose pricing types (Itemized, Flat Rate, Time & Material, Cost + Markup). Record partial payments to track outstanding balances. The aging report shows overdue amounts by customer. Expenses can be linked to specific jobs for profitability analysis or recorded as general business overhead. Dashboard KPIs show total revenue, outstanding balances, overdue amounts, and expense totals.",
            "Financials pull data from Jobs (materials and labor for invoices), Customers (billing info), Employees (labor rates), and Time Entries (hours worked). Payments link to specific invoices. Expense tracking supports both job-specific and general business expenses. Revenue data feeds the Dashboard KPIs.",
            ["Generate invoices from jobs to avoid re-entering line items — materials and labor transfer automatically.", "Track partial payments and outstanding balances per customer.", "Use the aging report to identify overdue accounts and follow up.", "Link expenses to specific jobs for accurate profitability analysis.", "Choose the right pricing type for each invoice — flat rate simplifies billing for customers."],
            [new("Jobs", "bi-briefcase", "/jobs"), new("Customers", "bi-people", "/customers"), new("Expenses", "bi-cash-stack", "/financials/expenses")]),
        new("Invoices", "bi-receipt-cutoff", "/financials/invoices",
            "Create, manage, and send professional invoices. Support for multiple pricing types: Material & Labor (Itemized), Flat Rate, Time & Material, Cost + Markup, and Service Agreement (Covered). Features include tax calculation, discounts, deposit tracking, payment recording, and professional PDF output with multiple template styles.",
            "Create invoices manually or generate from completed jobs. Add line items from your product catalog or enter custom descriptions. Choose pricing type — Flat Rate lets you enter a single total without itemized lines, while Itemized breaks down materials and labor separately. Use the 'Hide Line Item Prices' option to show items on the invoice without individual prices, displaying only the flat rate total — useful when you want customers to see what was done without per-item costs. Apply tax, discounts, and deposits. Choose from Professional, Classic, or Modern print templates. Send via email with PDF attachment. Record payments (partial or full) and track balance due.",
            "Invoices link to Customers (billing), Jobs (source data), Sites (location), Assets (equipment serviced), and Payments (amounts received). Line items can reference Products for consistent pricing. The status workflow (Draft → Sent → Paid / Overdue / Void) helps track the billing lifecycle.",
            ["Generate invoices from jobs to auto-populate materials and labor — saves significant time.", "Use 'Hide Line Item Prices' with Flat Rate pricing to show work performed without per-item costs.", "Track partial payments to maintain accurate outstanding balances.", "Professional, Classic, and Modern templates give you presentation options.", "Set payment terms (Net 15, Net 30, etc.) to clarify expectations with customers."],
            [new("Jobs", "bi-briefcase", "/jobs"), new("Customers", "bi-people", "/customers"), new("Financials", "bi-receipt", "/financials")]),
        new("Expenses", "bi-cash-stack", "/financials/expenses",
            "Track all business expenses: materials purchased, fuel, tools, permits, disposal fees, and more. Link expenses to specific jobs for profitability analysis or record as general business overhead.",
            "Add expenses with category, description, amount, tax, and payment method. Link to a specific job to track job-level profitability. Mark expenses as billable to include on customer invoices. Upload receipts as attached documents. Filter by status (Pending, Approved, Reimbursed), category, and date range. Expense totals feed into the Financials dashboard for overall business expense tracking.",
            "Expenses can link to Jobs (job-specific costs), Employees (who incurred it), and Documents (receipts). Billable expenses can be added to Invoices. Expense totals appear on the Dashboard and Reports.",
            ["Link expenses to jobs for accurate profitability tracking.", "Mark expenses as billable to recover costs from customers.", "Upload receipt images as documents for tax and audit purposes.", "Categorize consistently for useful expense reporting."],
            [new("Jobs", "bi-briefcase", "/jobs"), new("Documents", "bi-folder", "/documents"), new("Financials", "bi-receipt", "/financials")]),
        new("Service Agreements", "bi-file-earmark-check", "/serviceagreements",
            "Manage recurring service contracts with coverage levels (Basic, Standard, Premium, Custom), included visit counts, renewal dates, monthly/annual fees, and linked assets. Track visits used vs. included to stay within coverage limits.",
            "Create agreements linked to customers with coverage details, visit limits, and pricing. Monitor the dashboard for expiring agreements and renewal opportunities. Track visits used per period — the system warns when approaching limits. Link covered assets to agreements for warranty and maintenance tracking. Schedule recurring maintenance visits in the Calendar linked to the agreement. Set renewal alerts to proactively engage customers before contracts expire.",
            "Agreements link to Customers (who holds the contract), Assets (what's covered), Calendar (scheduled visits), Jobs (work performed under the agreement), Service History (maintenance records), and Financials (contract revenue). Agreement status drives Dashboard alerts for expiring contracts.",
            ["Set renewal alerts to proactively engage customers before expiry.", "Track visits used vs. included to avoid exceeding coverage limits.", "Link all covered assets to the agreement for complete warranty tracking.", "Use coverage levels to standardize your service offerings.", "Schedule recurring visits in the Calendar to stay ahead of maintenance."],
            [new("Customers", "bi-people", "/customers"), new("Calendar", "bi-calendar3", "/calendar"), new("Assets", "bi-cpu", "/assets"), new("Service History", "bi-wrench-adjustable", "/servicehistory")]),
        new("Calendar", "bi-calendar3", "/calendar",
            "Visual scheduling and dispatch planning with date, employee, and job filtering. Create events linked to jobs, employees, and service agreements. View daily, weekly, or monthly layouts for optimal resource planning.",
            "Create events linked to jobs and employees. Use the employee filter to check technician availability before assigning work. View by day, week, or month to plan dispatching. Calendar events can be created from Jobs (schedule a job) or Service Agreements (schedule maintenance visits). Color-coding helps distinguish event types. Drag events (if supported) to reschedule. Filter by technician to see individual workloads and prevent overbooking.",
            "Calendar events link to Jobs (scheduled work), Employees (assigned techs), and Service Agreements (recurring visits). Events auto-sync with job status changes — when a job is scheduled, it appears on the Calendar. Employee availability is visible here for smart dispatching.",
            ["Use employee filtering to check tech availability before assigning new work.", "Calendar events auto-sync with job status changes.", "Batch scheduling for multi-site customers optimizes tech travel routes and minimizes windshield time.", "Schedule service agreement visits in advance to stay ahead of contract obligations.", "Review weekly views to balance workloads across your team."],
            [new("Jobs", "bi-briefcase", "/jobs"), new("Employees", "bi-person-badge", "/employees"), new("Agreements", "bi-file-earmark-check", "/serviceagreements")]),
        new("Material Lists", "bi-list-check", "/materiallists",
            "Build structured, itemized material lists with sections (Equipment, Ductwork, Electrical, Piping, etc.), pricing methods, and reusable templates. Features include HVAC quick-add for duct sizing, product catalog integration, print/PDF output, email with attachments, and quick notes editing.",
            "Create material lists linked to customers, sites, and jobs. Add items grouped by section — use the HVAC Quick-Add tool for automated ductwork calculations (flex duct, supply/return trunks, boots, grills, dampers). Pull items from your product catalog for consistent pricing. Choose pricing methods (flat rate, time-based). Use templates to quickly populate common configurations. The detail sidebar shows customer/site/job info and quick notes for internal and external communication. Print in two formats: customer-facing (with or without prices) and supply house mode (prices hidden). Email PDFs directly to customers or suppliers. Internal and external notes appear on printouts when selected.",
            "Material Lists connect to Products (for pricing and catalog items), Jobs (what materials are needed for), Estimates (bid building), Inventory (stock tracking), Templates (reusable structures), Customers (who it's for), and Sites (where). Items from material lists can deduct from inventory when jobs are completed.",
            ["Create templates for common job types (AC install, furnace replacement, duct repair) to speed up bidding.", "Use the HVAC Quick-Add tool for automated ductwork calculations — saves significant time.", "Internal notes are for your team; external notes appear on customer-facing printouts.", "Supply house mode prints item lists without prices for ordering from suppliers.", "Link material lists to jobs before dispatch so technicians know what to bring."],
            [new("Products", "bi-box-seam", "/products"), new("Estimates", "bi-calculator", "/estimates"), new("Templates", "bi-copy", "/templates"), new("Jobs", "bi-briefcase", "/jobs")]),
        new("Documents", "bi-folder-fill", "/documents",
            "Centralized document vault for manuals, warranties, permits, photos, contracts, receipts, and any business files. Supports access levels (Public, Private, Role-Based, Customer Only) and links to any entity in the system.",
            "Upload documents with category tags, descriptions, and access levels. Link to customers, jobs, assets, invoices, or any entity. Filter by category, linked entity, and access level. Documents support image preview for photos. Use the document vault to store warranty certificates, equipment manuals, installation photos, permits, and signed contracts. Access levels control who can view each document — use 'Customer Only' for documents shared with clients.",
            "Documents link to all entity types via polymorphic relationships — Customers, Jobs, Assets, Sites, Invoices, Service Agreements, and more. Photos attached to jobs appear in the job detail view. Warranty documents linked to assets support claim filing.",
            ["Use access levels to control who sees sensitive documents.", "Link warranty documents to assets for easy reference during claims.", "Attach before/after photos to jobs for customer communication and dispute resolution.", "Store signed contracts and permits for compliance and audit trails.", "Organize with categories for easy retrieval."],
            [new("Assets", "bi-cpu", "/assets"), new("Jobs", "bi-briefcase", "/jobs"), new("Customers", "bi-people", "/customers")]),
        new("Quick Notes", "bi-sticky-fill", "/quicknotes",
            "Fast capture of ad-hoc information with urgency flags, entity links, and category tagging. Perfect for field observations, customer requests, site details, and anything that needs to be remembered and acted on later.",
            "Create notes quickly with a title, description, and optional urgency flag (Low, Normal, High, Urgent). Link notes to any entity — customers, jobs, sites, assets. Browse via card layout with filtering by category and urgency. Import note content into job descriptions, material lists, or estimates to avoid retyping. Notes can be used as a scratch pad for site observations during visits — then imported into proper records later.",
            "Quick Notes can link to any entity — Jobs, Customers, Sites, Assets, and more. Note content can be imported into Job descriptions, Material Lists, and Estimates. Urgency flags drive Dashboard alerts for high-priority items.",
            ["Use urgency flags for time-sensitive site observations that need immediate follow-up.", "Import note content into jobs or estimates to avoid retyping — saves time and ensures accuracy.", "Link notes to specific entities so they appear in the entity's detail view.", "Use notes as a field scratch pad — capture site details, then organize later.", "Review and clear resolved notes regularly to keep the list manageable."],
            [new("Jobs", "bi-briefcase", "/jobs"), new("Customers", "bi-people", "/customers"), new("Sites", "bi-geo-alt", "/sites")]),
        new("Reports", "bi-graph-up", "/reports",
            "Analytics dashboards, standard report templates, KPI tracking, and complete audit logs for accountability. View revenue trends, job completion rates, employee performance, inventory status, and more.",
            "Browse report templates organized by category (Financial, Operational, Inventory, Employee). View KPI analytics with real-time data — revenue trends, job completion rates, average response times, and customer satisfaction metrics. Filter all reports by date range and category. The audit log tracks every data change in the system for accountability and compliance — who changed what, when, and the before/after values. Export reports for external use.",
            "Reports aggregate data from all modules — Jobs, Financials, Inventory, Employees, Customers, and more. The audit log captures changes system-wide for compliance. Report data can be exported for use in external tools.",
            ["Use the Analytics tab for real-time KPI monitoring.", "Audit logs track every data change for accountability — useful for resolving disputes.", "Filter reports by date range to focus on specific periods.", "Export reports regularly for tax preparation and business planning.", "Review employee performance metrics to identify training needs."],
            [new("Financials", "bi-receipt", "/financials"), new("Jobs", "bi-briefcase", "/jobs"), new("Employees", "bi-person-badge", "/employees")]),
        new("Settings", "bi-gear-fill", "/settings",
            "The central configuration hub: company profile and branding, user accounts and roles, dropdown customization for all forms, notification preferences, default tax rates, and data management (export, import, backup). Changes here propagate throughout the entire app.",
            "Company Profile: Set your business name, address, phone, email, logo, and tax ID — this appears on all printouts and PDFs. Users & Roles: Add team members with role-based access (Owner, Admin, Dispatcher, Tech, Manager). Customizations: Edit dropdown options for all pages — priorities, property types, equipment categories, line types, and more. Notifications: Configure which events trigger alerts. Data Management: Export all data as CSV, export individual tables, import from CSV, and download full database backups. Default Tax Rate: Set the rate that auto-fills on new invoices.",
            "Settings propagate to all pages. Dropdown options appear in every form. Company profile data shows on all printouts, PDFs, and email templates. User roles control access across the app. Tax rates default on new invoices.",
            ["Customize dropdowns first — they appear across all forms throughout the app.", "Use Data Management to export CSV backups regularly — store them offsite.", "Set your default tax rate to avoid manual entry on every invoice.", "Configure notification preferences to stay informed without being overwhelmed.", "Review user roles to ensure appropriate access levels for your team."],
            [new("Reports", "bi-graph-up", "/reports"), new("Dashboard", "bi-speedometer2", "/")]),
        new("Templates", "bi-copy", "/templates",
            "Reusable blueprint library for material lists, job checklists, estimate formats, and product configurations. Templates eliminate repetitive setup for common job types — clone and customize per customer for personalized bids.",
            "Create templates with structured content — material list items grouped by section, with quantities and notes. Clone templates to create site-specific variants for different customers. Apply templates when building new estimates, jobs, or material lists for consistent, fast setup. Templates track usage count and last-used date to identify your most popular configurations. Archive rarely-used templates to keep the list clean.",
            "Templates connect to Material Lists (populate items), Products (reference catalog), Jobs (standard checklists), and Estimates (bid structures). When applied, template items create actual line items in the target entity — they're a starting point that can be customized.",
            ["Templates eliminate repetitive setup for common job types — build once, reuse everywhere.", "Clone templates per customer or site for personalized bids.", "Track usage to identify your most popular configurations.", "Organize by type (HVAC, Plumbing, Electrical) for easy browsing.", "Archive old templates instead of deleting to preserve historical reference."],
            [new("Material Lists", "bi-list-check", "/materiallists"), new("Products", "bi-box-seam", "/products"), new("Estimates", "bi-calculator", "/estimates")]),
        new("Service History", "bi-wrench-adjustable", "/servicehistory",
            "Track warranty claims and non-warranty repairs with evidence documentation, resolution tracking, cost tracking, and claim actions (Filed, Under Review, Approved, Denied). Complete maintenance and repair history per asset.",
            "Create service history records from jobs or directly from assets. Log the type (Warranty, Non-Warranty, Preventive Maintenance, Emergency), description, resolution, and cost. For warranty claims: attach evidence (photos, documents), set claim status, track manufacturer responses, and log reimbursement amounts. The history builds a complete maintenance timeline per asset — valuable for warranty claims, customer communication, and equipment lifecycle planning.",
            "Service History links to Customers (whose equipment), Sites (where), Assets (what equipment), Jobs (work performed), Documents (evidence), and Financials (reimbursement tracking). Claim data helps track manufacturer responsiveness and reimbursement rates.",
            ["Attach photos and documents as evidence for warranty claims — manufacturers require documentation.", "Track reimbursements to ensure manufacturers pay on time.", "Build complete maintenance timelines per asset for customer transparency.", "Use preventive maintenance records to demonstrate regular service for warranty compliance.", "Log resolution details to build a knowledge base for recurring issues."],
            [new("Assets", "bi-cpu", "/assets"), new("Jobs", "bi-briefcase", "/jobs"), new("Documents", "bi-folder", "/documents")]),
        new("Suppliers", "bi-truck", "/suppliers",
            "Manage your supply chain — distributors, manufacturers, and vendors with contact details, product catalogs, and order history. Link suppliers to products and inventory for streamlined purchasing.",
            "Add suppliers with contact information, account numbers, and product associations. Track preferred suppliers per product for consistent ordering. The supplier detail view shows linked products and recent order activity. Use supplier information when placing orders — having account numbers and contacts readily available speeds up purchasing. Filter by active status and search by name or contact info.",
            "Suppliers link to Products (who supplies what), Inventory (reorder sources), and Documents (purchase orders, invoices from suppliers). Supplier data helps streamline the purchasing workflow when inventory needs restocking.",
            ["Link suppliers to products so you know where to order each item.", "Keep supplier account numbers and contacts current for fast purchasing.", "Track multiple suppliers per product for backup options.", "Archive inactive suppliers instead of deleting to preserve order history."],
            [new("Products", "bi-box-seam", "/products"), new("Inventory", "bi-boxes", "/inventory")]),
        new("Search", "bi-search", "/search",
            "Universal cross-entity search across all entity types: customers, jobs, sites, estimates, assets, employees, invoices, documents, service agreements, and products. Results are grouped by category with counts and filter chips.",
            "Type in the header search bar from any page — results open in the Search page grouped by entity type. Use category filter chips to narrow results (e.g., show only Jobs or Customers). Results show key info for each entity type — click any result to navigate directly to its detail view. The search is full-text across names, descriptions, numbers, addresses, and other key fields.",
            "Search queries run across all entity types — Jobs, Customers, Sites, Estimates, Assets, Employees, Invoices, Documents, Service Agreements, and Products. Results link directly to entity detail views.",
            ["Use the header search bar from any page — it's the fastest way to find anything.", "Filter by category to narrow results when you get too many matches.", "Search by invoice number, job number, or customer phone for precise results.", "The search indexes names, descriptions, addresses, phone numbers, and reference numbers."],
            []),
    ];

    private WorkflowGuide[] _workflows =
    [
        new("Estimate to Invoice (Full Lifecycle)", "bi-arrow-right-circle",
            "The complete bid-to-payment lifecycle — from customer request through material estimation, job execution, and final payment collection. This is the primary revenue workflow.",
            ["Create or select the Customer and add a Site with property details (address, zones, sq ft, access notes)", "Build a Material List with sections and pricing — use the HVAC Quick-Add for ductwork or add items from the product catalog", "Create an Estimate from the material list with markup, labor, and tax — review margins in the pricing summary", "Send the estimate to the customer via email with PDF attachment", "Track estimate status — follow up on pending bids", "When the customer approves, convert the Estimate to a Job — all materials, customer, and site data transfer automatically", "Schedule the Job in the Calendar and assign a certified technician", "Technician executes work, updates status (En Route → On Site → In Progress → Completed), and logs time entries", "Generate an Invoice from the completed Job — materials and labor auto-populate as line items", "Send the Invoice via email with professional PDF attachment", "Record partial or full Payments and track balance due", "Close the Job when fully paid"],
            [new("Estimates", "bi-calculator", "/estimates"), new("Jobs", "bi-briefcase", "/jobs"), new("Material Lists", "bi-list-check", "/materiallists"), new("Financials", "bi-receipt", "/financials")]),
        new("Emergency Dispatch", "bi-exclamation-triangle",
            "Rapid response workflow for urgent service calls — minimize dispatch time with certification-aware scheduling. Use when a customer calls with an emergency (no cooling in summer, no heat in winter, gas leak, water leak).",
            ["Receive emergency call — create or find the Customer record quickly", "Quick-create a Job with Emergency priority and relevant details", "Check the Calendar for available technicians with the right certifications (EPA 608 for refrigerant, etc.)", "Assign the technician and the Job status updates to Scheduled — tech receives notification", "Technician updates status on mobile: En Route → On Site → In Progress → Completed", "Technician logs time entries and materials used during the repair", "Generate an Invoice from the completed Job with appropriate pricing (emergency rates if applicable)", "Send invoice and record payment"],
            [new("Jobs", "bi-briefcase", "/jobs"), new("Calendar", "bi-calendar3", "/calendar"), new("Employees", "bi-person-badge", "/employees")]),
        new("Service Agreement Lifecycle", "bi-arrow-repeat",
            "Manage recurring service contracts from creation through scheduled visits, renewals, and warranty tracking. Ideal for maintenance contracts, annual tune-ups, and warranty programs.",
            ["Create a Service Agreement linked to the Customer with coverage level (Basic/Standard/Premium), visit count, and pricing", "Link all covered Assets to the agreement (HVAC units, furnaces, heat pumps, etc.)", "Schedule recurring maintenance visit events in the Calendar — assign technicians", "Technician performs scheduled maintenance and logs work in the Job", "Track visits used vs. included per billing period — system warns when approaching limits", "Log Service History records for each visit — builds maintenance timeline per asset", "Monitor renewal dates on the Dashboard — proactively engage customers before expiry", "Generate a renewal Estimate before the agreement expires to maintain the relationship"],
            [new("Agreements", "bi-file-earmark-check", "/serviceagreements"), new("Calendar", "bi-calendar3", "/calendar"), new("Assets", "bi-cpu", "/assets"), new("Service History", "bi-wrench-adjustable", "/servicehistory")]),
        new("Asset Lifecycle", "bi-recycle",
            "From product catalog to installation, maintenance, warranty tracking, and eventual decommissioning — the complete lifecycle of installed equipment.",
            ["Add the Product to your catalog with full specs (tonnage, SEER, model, refrigerant type) and pricing", "Customer approves an Estimate that includes the equipment — convert to a Job", "Technician installs the equipment on the Job — creates an Asset record linked to the Customer and Site", "Record warranty information: start date, end date, manufacturer, coverage details", "Link warranty documents (receipts, certificates) to the Asset", "Schedule preventive maintenance visits via Service Agreements", "Track every service visit in Service History — builds the complete maintenance timeline", "If warranty issue arises: file a claim with evidence (photos, service records) and track manufacturer response", "When equipment reaches end-of-life: update status to Decommissioned and plan replacement"],
            [new("Products", "bi-box-seam", "/products"), new("Assets", "bi-cpu", "/assets"), new("Service History", "bi-wrench-adjustable", "/servicehistory"), new("Agreements", "bi-file-earmark-check", "/serviceagreements")]),
        new("Inventory Restocking", "bi-box-seam",
            "Monitor stock levels, identify items below reorder points, and replenish from suppliers. Prevent job delays caused by missing parts.",
            ["Dashboard shows low-stock items below reorder threshold — review alerts daily", "Check Inventory KPIs for expiring or depleted items that need attention", "Identify items that need reordering — check linked Suppliers for each product", "Place orders with suppliers using account numbers and contacts from the supplier records", "Receive shipment and update stock quantities in Inventory", "Verify counts with batch adjustment if doing a full stock count", "Update product pricing if supplier prices have changed"],
            [new("Inventory", "bi-boxes", "/inventory"), new("Products", "bi-box-seam", "/products"), new("Suppliers", "bi-truck", "/suppliers")]),
        new("Multi-Site Customer Setup", "bi-buildings",
            "Configure landlord, property management, or commercial customers with multiple sites, assets, and agreements. Optimized for contractors who service many locations for a single customer.",
            ["Create the Customer with Commercial or Property Management type and primary contact info", "Add multiple Sites under the customer — each with full address, property details, access instructions, and zone/sq ft data", "Link Assets to each site (all HVAC units, furnaces, heat pumps at each property)", "Create a Service Agreement covering all sites with appropriate visit counts", "Schedule batch maintenance visits in the Calendar — group nearby sites for efficient routing", "Use territorial filtering to optimize technician assignments by geographic area", "Track all work per site — each Site detail shows its own job history, assets, and notes"],
            [new("Customers", "bi-people", "/customers"), new("Sites", "bi-geo-alt", "/sites"), new("Agreements", "bi-file-earmark-check", "/serviceagreements"), new("Calendar", "bi-calendar3", "/calendar")]),
        new("Warranty Claim Process", "bi-shield-check",
            "File and track warranty claims with manufacturers — from identifying the issue through documentation, submission, and reimbursement.",
            ["Identify the warranty issue during a service call — verify the asset is still under warranty in the Asset detail view", "Document the issue with photos (before/after) and detailed description in the Job notes", "Create a Service History record of type 'Warranty' linked to the Asset and Job", "Attach all evidence: photos, original purchase receipt, warranty certificate, and service records", "Set the claim status to 'Filed' and record the date submitted to the manufacturer", "Track manufacturer response — update status (Under Review, Approved, Denied)", "If approved: record the reimbursement amount and payment date", "If denied: document the reason and consider escalation options"],
            [new("Assets", "bi-cpu", "/assets"), new("Service History", "bi-wrench-adjustable", "/servicehistory"), new("Documents", "bi-folder", "/documents")]),
        new("New Equipment Installation", "bi-tools",
            "Complete workflow for installing new equipment — from initial bid through installation, asset tracking, and warranty setup.",
            ["Meet with the customer to assess the Site — note zones, square footage, existing equipment, and access requirements", "Use the HVAC Quick-Add tool in Material Lists to calculate ductwork (flex duct sizes, supply/return trunks, boots, grills)", "Build a comprehensive Estimate with equipment, materials, labor, and markup", "Upon approval, convert to a Job with all materials and schedule the installation", "Assign certified technicians and ensure the Calendar shows no conflicts", "During installation: technician logs time entries and verifies all materials used", "Create Asset records for installed equipment — include serial numbers, model, specs, and warranty info", "Upload installation photos and warranty documents to the asset", "Generate the Invoice from the completed job", "Set up a Service Agreement for ongoing maintenance coverage"],
            [new("Material Lists", "bi-list-check", "/materiallists"), new("Estimates", "bi-calculator", "/estimates"), new("Jobs", "bi-briefcase", "/jobs"), new("Assets", "bi-cpu", "/assets")]),
        new("Daily Office Workflow", "bi-clock-history",
            "Recommended daily routine for dispatchers and office staff to stay on top of operations.",
            ["Start on the Dashboard — review unscheduled jobs, overdue invoices, and expiring agreements", "Check the Calendar for today's scheduled jobs and technician assignments", "Review any new Quick Notes with high urgency flags", "Follow up on outstanding Estimates — contact customers on pending bids", "Process completed Jobs — generate Invoices and send to customers", "Record any Payments received", "Check Inventory for low-stock alerts and place reorder requests", "Review and respond to any warranty claim updates in Service History", "End of day: review tomorrow's schedule and confirm technician assignments"],
            [new("Dashboard", "bi-speedometer2", "/"), new("Calendar", "bi-calendar3", "/calendar"), new("Jobs", "bi-briefcase", "/jobs"), new("Financials", "bi-receipt", "/financials")]),
    ];

    private FaqItem[] _faqs =
    [
        new("How do I handle multi-site landlord customers?", "Create the customer with a Commercial or Property Management type, then add multiple sites under them. Each site has its own address, zones, access notes, and assets. Use territorial filtering in Calendar for efficient dispatch to grouped locations. Service Agreements can cover all sites under one contract.", "Customers", "/customers"),
        new("How do data transfers work between pages?", "When you convert an estimate to a job, material lists, customer info, and site data carry over automatically. Invoice generation pulls job materials and labor hours for billing. Asset creation from jobs links service history. This eliminates re-entry across the workflow. The key principle: data entered once flows forward through the entire lifecycle.", "Data Flow"),
        new("Can I customize dropdown options?", "Yes — go to Settings > Customizations to add, edit, or remove dropdown entries like job priorities, equipment types, property types, line types, and more. Changes apply across all pages immediately. Customize these first before creating data for consistent categorization.", "Settings", "/settings"),
        new("How do Quick Notes integrate with other pages?", "Notes auto-link to the entity they were created from (job, customer, asset, etc.). You can import note content into job descriptions, material lists, or other fields. Use urgency flags for time-sensitive observations. Notes appear in the linked entity's detail view for reference.", "Quick Notes", "/quicknotes"),
        new("What is the difference between pricing types on invoices?", "'Material & Labor (Itemized)' shows separate line items grouped by type with individual prices. 'Flat Rate' lets you enter a single total price without itemized lines. 'Time & Material' calculates from logged hours and materials used. 'Cost + Markup' applies a percentage on top of costs. 'Service Agreement (Covered)' is for work covered under a contract.", "Invoices", "/financials/invoices"),
        new("How do I hide individual prices on an invoice?", "When editing an invoice, check the 'Hide Line Item Prices' option in the Display Options section. This will list all items on the invoice without individual Qty, Unit Price, and Amount columns — only showing descriptions and the flat total at the bottom. This is useful when you want customers to see what work was done without per-item costs.", "Invoices", "/financials/invoices"),
        new("How do I track warranty claims?", "Go to Service History and create a Warranty record linked to the asset and job. Attach evidence (photos, documents), set the claim status, and track manufacturer responses. Reimbursement amounts are logged for financial reporting. Keep evidence thorough — manufacturers require documentation.", "Service History", "/servicehistory"),
        new("How do I export my data?", "Go to Settings > Data Management. You can export all tables as a combined CSV, export individual tables, or download a full database backup file. Use CSV imports to bulk-load data from other systems. Regular backups are recommended — store offsite for disaster recovery.", "Data Management", "/settings"),
        new("How do I add a new user?", "Navigate to Settings > Users and Roles and click Add User. Fill in username, email, password, and assign a role (Owner, Admin, Dispatcher, Tech, Manager). Users can be activated, deactivated, or locked from the same screen. Roles control access levels throughout the app.", "Users", "/settings"),
        new("Can I schedule recurring service visits?", "Create a Service Agreement with included visit counts, then schedule individual events in the Calendar linked to that agreement. Track visits used vs. included to stay within coverage limits. Set renewal alerts to proactively engage customers before contracts expire.", "Agreements", "/serviceagreements"),
        new("How do I generate an invoice from a completed job?", "Once a job is marked Completed or Closed, navigate to the Financials page and create a new invoice. Select the job from the 'Linked Job' dropdown — materials, labor time entries, and customer data auto-populate the invoice lines. Choose your pricing type, add tax and any discounts, then send.", "Financial", "/financials"),
        new("What happens when inventory runs low?", "Items below their reorder point trigger a Low Inventory alert on the Dashboard and in Notifications (if enabled in Settings). The Inventory KPI dashboard highlights critical items for restocking. Review these alerts daily to prevent job delays from missing parts.", "Inventory", "/inventory"),
        new("How do document access levels work?", "Documents can be set to Public (everyone), Private (owner only), Role-Based (specific roles), or Customer Only (shared with customer portal). Set access when uploading or edit later. Use Private for internal documents and Customer Only for documents you want to share with clients.", "Documents", "/documents"),
        new("How does the HVAC Quick-Add tool work?", "In Material Lists, click the HVAC Quick-Add button to open a multi-tab tool for automated ductwork calculations. Enter flex duct sizes, supply/return trunk dimensions, boots, grills, and miscellaneous items. The tool calculates quantities and adds all items to your material list in the correct sections — saving significant time on HVAC installation bids.", "Material Lists", "/materiallists"),
        new("How do I print material lists for different audiences?", "Material Lists support two print modes: customer-facing (with or without prices) and supply house mode (prices hidden, optimized for ordering). Use the print toggles to include or exclude external notes and internal notes. External notes appear on customer copies; internal notes are for your team only.", "Material Lists", "/materiallists"),
        new("How do archived records work?", "Archiving is a soft delete — the record is hidden from normal views but preserved in the database. Toggle 'Show Archived' to see archived records. Archived items can be restored to active status or permanently deleted. Use archiving instead of deleting to preserve historical data for reporting and auditing.", "Data Management"),
        new("How do I change my company information on printouts?", "Go to Settings > Company Profile and update your business name, address, phone, email, tax ID, and logo. These details appear on all printed documents — invoices, estimates, material lists, and PDFs. Changes take effect immediately on new printouts.", "Settings", "/settings"),
        new("Can I send invoices and estimates via email?", "Yes — both Invoices and Estimates have an Email button that generates a professional PDF attachment and opens an email composition dialog. If SMTP is configured in Settings, emails are sent directly from the app. Otherwise, the system opens your default email client with the recipient, subject, and body pre-filled.", "Email"),
        new("How do I set the default tax rate?", "Go to Settings > Company Profile and set the Default Tax Rate. This rate auto-fills when creating new invoices, saving you from entering it manually each time. You can still override it per invoice if needed.", "Settings", "/settings"),
        new("What do the different job statuses mean?", "New: Just created. Scheduled: Date and tech assigned. En Route: Tech is traveling to site. On Site: Tech has arrived. In Progress: Work actively happening. Paused: Temporarily stopped (waiting for parts, etc.). Completed: Work finished, pending billing. Closed: Invoiced and paid. Each status change can trigger notifications.", "Jobs", "/jobs"),
        new("How do I handle a job that needs additional parts?", "If a technician discovers additional parts are needed, they can Pause the job with a note explaining what's needed. Update the Material List with the additional items, check Inventory for availability, and order from suppliers if needed. When parts arrive, resume the job.", "Jobs", "/jobs"),
    ];

    private TipItem[] _tips =
    [
        new("Use Global Search", "The header search bar finds customers, jobs, invoices, assets, and more across all entity types instantly. Results are grouped by category with filter chips. It's the fastest way to find anything in the app.", "Efficiency", "/search"),
        new("Dashboard First", "Start your day on the Dashboard — it surfaces urgent items like unscheduled jobs, overdue invoices, expiring agreements, and low inventory. Click any KPI card to navigate directly to the filtered view.", "Efficiency", "/"),
        new("Templates Save Time", "Create material list and job templates for common work types (AC install, furnace replacement, duct repair). Clone them when building new estimates — all items, sections, and notes carry over.", "Efficiency", "/templates"),
        new("Customize Dropdowns Early", "Set up dropdown options in Settings > Customizations before creating data. This ensures consistent categorization across all pages — priorities, property types, equipment categories, and line types.", "Efficiency", "/settings"),
        new("Archive Instead of Delete", "Use Archive instead of Delete to preserve historical data. Archived records are hidden from normal views but can be restored anytime. Toggle 'Show Archived' to view, restore, or permanently delete.", "Efficiency"),
        new("Keyboard Shortcuts in Forms", "Use Tab to move between fields quickly. Most forms save on Enter when focused on the save button. Use the search bars on list pages to filter without navigating away.", "Efficiency"),
        new("Bulk Actions Save Time", "Use the checkboxes on list pages to select multiple records, then use the bulk action bar to archive, restore, or delete them all at once — much faster than processing one at a time.", "Efficiency"),
        new("Quick Notes on Mobile", "Use the floating action button to capture site details, photos, and observations in the field without leaving your current task. Import notes into jobs later.", "Mobile"),
        new("Offline Access", "The mobile app caches job details, site info, and documents for offline use. Changes sync automatically when connectivity returns. Work in the field without worrying about signal.", "Mobile"),
        new("Mobile Time Clock", "Clock in/out from the mobile app with GPS tracking. Time entries auto-link to the assigned job for accurate labor billing on invoices.", "Mobile"),
        new("Mobile Status Updates", "Technicians can update job status on mobile (En Route → On Site → In Progress → Completed). Status changes are visible in real-time to dispatchers in the office.", "Mobile"),
        new("Batch Scheduling", "For multi-site customers, schedule sequential jobs in the Calendar to optimize tech travel routes and minimize windshield time. Group nearby sites together.", "Scheduling", "/calendar"),
        new("Certification Dispatching", "When assigning techs, check their certifications (EPA 608, NATE) in the Employee profile to ensure qualified dispatch. Send the right tech for the job the first time.", "Scheduling", "/employees"),
        new("Calendar Filtering", "Use employee filtering in the Calendar to check individual technician availability. This prevents overbooking and helps balance workloads across your team.", "Scheduling", "/calendar"),
        new("Renewal Alerts", "Set alerts for Service Agreements approaching expiry. Proactively contact customers with renewal estimates to maintain ongoing relationships and revenue.", "Scheduling", "/serviceagreements"),
        new("Track Warranties", "Link warranty documents to assets for easy reference during service calls. Set expiration alerts to file claims before deadlines. Keep evidence thorough — manufacturers require documentation.", "Field Work", "/assets"),
        new("Photo Evidence", "Attach before/after photos to jobs and service history records. These support warranty claims, customer communication, and dispute resolution. Photos are worth a thousand words.", "Field Work", "/documents"),
        new("Site Access Notes", "Add detailed access instructions to sites — gate codes, key locations, parking spots, and entry points. Technicians appreciate knowing how to get into the property before arriving.", "Field Work", "/sites"),
        new("Material List Quick Notes", "Use the Quick Notes card in the material list detail sidebar to quickly update internal and external notes without opening the full edit form. Internal notes are for your team; external notes appear on customer copies.", "Field Work", "/materiallists"),
        new("Regular Backups", "Use Settings > Data Management to download database backups weekly. Store offsite for disaster recovery. CSV exports are also useful for external reporting.", "Data Management", "/settings"),
        new("CSV Import/Export", "Bulk-load customers, products, and inventory from CSV files. Export data for reporting in Excel or other tools. Use imports when migrating from another system.", "Data Management", "/settings"),
        new("Audit Trail", "Every change in the system is logged in the audit trail (Reports > Audit Log). Use this for accountability, dispute resolution, and compliance tracking.", "Data Management", "/reports"),
        new("Partial Payments", "Record partial payments against invoices to track outstanding balances accurately. The aging report shows overdue amounts by customer — follow up proactively.", "Financial", "/financials"),
        new("Expense Tracking", "Log business expenses (materials, fuel, tools, permits) against jobs for profitability analysis, or as general overhead for tax reporting. Mark billable expenses to recover from customers.", "Financial", "/financials"),
        new("Flat Rate Invoicing", "Use 'Flat Rate' pricing type with 'Hide Line Item Prices' to present a clean invoice showing what was done without per-item costs. Customers see the work performed but only one total price.", "Financial", "/financials/invoices"),
        new("Invoice Templates", "Choose between Professional (Navy), Classic (B&W), and Modern (Teal) print templates for invoices. Select the style that matches your business branding.", "Financial", "/financials/invoices"),
        new("Product Catalog First", "Set up your product catalog early. Products with accurate pricing feed into material lists, estimates, and invoices — reducing errors and ensuring consistent pricing across all documents.", "Efficiency", "/products"),
        new("Supply House Printing", "Print material lists in supply house mode to get a clean list without prices for ordering from your distributor. The format is optimized for handing to your supplier.", "Field Work", "/materiallists"),
    ];
}
