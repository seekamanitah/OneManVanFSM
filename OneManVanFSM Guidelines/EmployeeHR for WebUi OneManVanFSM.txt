Employee/HR for WebUi OneManVanFSM

### Employees (HR/Operations) Page - Exhaustive Description

**Routes**: `/employees` (list view for browsing, searching, and managing all employees/techs); `/employees/{id}` (detail view for a specific employee, including performance, time clock history, and quick actions); `/employees/new` or `/employees/{id}/edit` (create/edit view for adding or updating employee records). For contextual integration, embeddable as a component or modal in related pages like Jobs (e.g., `/jobs/{jobId}/employees` to assign or view techs for a job) or Calendar (e.g., `/calendar/employees/{date}` for checking availability and scheduling). This ensures seamless workflow—e.g., while dispatching a job, open an embedded employee selector without leaving, with data (e.g., tech certifications matching the job's requirements like refrigerant handling) transferring automatically to suggest optimal assignments, reducing steps for the contractor balancing team workloads during peak HVAC seasons.

**Purpose & Business Context**:
- The Employees (HR/Operations) page is designed as the comprehensive "team manager" for the app, handling everything from hiring/onboarding to daily operations like time tracking, payroll, certifications, and performance—serving as the human element that ties into every workflow where labor is involved. For a small HVAC contractor, it addresses the need for reliable, certified staff: E.g., assign an EPA-certified tech to a refrigerant-related repair at a company's territorial site, track their time on a multi-zone install (with overtime calcs for long days), reimburse expenses from a job-site purchase (e.g., extra zip ties), and review performance based on completed repairs across customer assets—all while ensuring compliance (e.g., certification expirations auto-flag unschedulable techs). Presentation emphasizes practicality: List views provide quick overviews with availability calendars and cert badges, while details offer a "employee file" with timeline of jobs/pay/history for reviews or payroll.
- HVAC-specific: Prioritizes certs like EPA 608 for refrigerant, NATE for system knowledge, or OSHA for safety—with fields for expiration alerts tied to job assignments (e.g., can't schedule uncertified tech for a trunk system install). Generic foundation: Adaptable for other trades without app changes—e.g., repurpose "EPA Cert" fields for "Master Plumber License" in plumbing (state-specific expirations) or "Journeyman Electrician" in electrical (voltage handling ratings), using customizable cert types to adjust while maintaining core HR (rates/time/payroll). This supports small teams: A contractor with territorial divisions (e.g., techs assigned to East/West sites for company clients) or multi-job days (e.g., landlord rentals requiring overtime tracking).
- Business value: Promotes user-friendly efficiency by automating shared data transfer—e.g., a tech's time clock from a job (mobile punch-in at site) prepopulates payroll (with overtime from hours/rates), expenses from material variances link to reimbursements, and certs filter job/calendar assignments (no manual checks). Industry thinking: Contractors rely on skilled, available labor (e.g., cert-based dispatch for emergencies); the page supports this with mobile time clock for techs (clean, swipe-to-punch UI), prepopulated customizable dropdowns (e.g., "Role: Lead Tech" editable in settings to add "Apprentice Plumber"), and shared data (e.g., a tech's repair history from jobs/assets flows to performance reviews/pay bonuses). For territorial companies or multi-site customers (e.g., landlords), employees can be "zoned" (e.g., assign by territory/contact preference), with notifications routing correctly (e.g., overtime alert to manager). Overall robustness: Connectivity ensures compliance and cost control—e.g., time entries from jobs update financials (labor in invoices/expenses), cert expirations block scheduling, and payroll calcs (with overtime rules) tie to reports for profitability by tech.

**Data Sources & Interconnections**:
- **Core Entity**: Employees table (ID PK, Name/Role enum: Tech/Dispatcher/Manager – customizable; Certs JSON/array with types/expirations (e.g., "EPA 608: Expires 2027"); Rate (hourly/salary – for time-based calcs), Availability (JSON calendar/blackout dates); Notes/Attachments for apps/certs). One-to-Many with TimeEntries (ID/JobID/Start/End/Hours – for clock logs), PayrollRecords (PayPeriod/Amount/Overtime – computed), Expenses (reimbursements).
- **Sources**: Prepopulates from Settings (default roles/rates/certs – customizable per trade, e.g., add "OSHA 30" for safety); integrates with external (e.g., background check APIs if added).
- **Interconnections** (App-Wide Flow for Shared Labor Data):
  - **Jobs/Calendar/Estimates**: Many-to-Many (JobWorkers junction with EmployeeID). Connectivity: Employee certs/availability filter assignments (e.g., suggest EPA tech for refrigerant job); time entries from job clock (mobile at site) transfer to employee logs (data flow: Hours to payroll/overtime calcs). App flow: Job detail "Assign Tech" embeds employee selector (prepopulates by cert/location – customizable filters); calendar views employee slots (transfer to job scheduling); estimates use rates for labor previews (transfer to job on conversion).
  - **Sites/Customers/Companies**: Indirect via jobs (tech assignment by territorial preference). Connectivity: Employee "Zoned" fields (customizable dropdown like "East County") route jobs/notifications; multi-site jobs (e.g., landlord rentals) batch assign techs with shared availability. App flow: Customer detail "Assigned Techs" filters employee list (data transfer to new job); company territorial: Auto-filter employees by contact (e.g., West techs for Jill Dane).
  - **Assets/Material Lists/Inventory/Products**: Indirect via jobs (repair logs by tech). Connectivity: Tech certs validate asset jobs (e.g., can't assign uncertified to fire damper install); material list labor (hours/rates from employee) transfers to time entries. App flow: Asset repair "Schedule with Tech" pulls certified employees (data transfer to job); inventory adjustments (e.g., tech purchase) create employee expenses.
  - **Invoices/Expenses/Payments**: One-to-Many (Expense EmployeeID FK; Invoice labor from time entries). Connectivity: Time logs calculate labor lines in invoices (data flow: Hours × Rate to totals, overtime to expenses); reimbursements (e.g., fuel for site visit) link to payments. App flow: Invoice detail embeds time summary (transfer from employee logs); payroll from aggregated time (customizable periods like bi-weekly).
  - **ServiceAgreements/QuickNotes/Notifications**: Agreements assign recurring to certified techs; quick notes import to employee notes (e.g., "Cert Renewal" category flags expiration). Connectivity: Notification for cert expiry (blocks scheduling); quick note on job → Imports to employee performance (e.g., "Good Work" for reviews).
  - **Shared Data Flow**: Employee create (add certs/rates/availability) → Job assignment (filter by cert/territory, transfer to calendar slot) → Time clock on job (mobile log hours at site) → Update employee/payroll (transfer to overtime/expenses) → Invoice generation (labor from time/rates) → Reports (performance by jobs/assets/sites). For territorial: "Assign by Zone" auto-routes (shared data like availability aggregates for company overviews). Robust views: "EmployeePerformanceView" (joins jobs/time for KPIs); "PayrollCalcView" (aggregates hours/overtime for periods).

**Layout & Sections** (Desktop Web Focus: Profile-Style with Timelines, Responsive for Mobile Card-Stacking):
- **List View (/employees)**: Searchable table (columns: Name/Role (dropdown filter – customizable), Certs (badges with expirations), Rate/Availability (calendar snippet), Performance Score (from jobs), Assigned Jobs Count – sortable/prepopulated like "Certified Only" dropdown). Groupable by role/territory for team overviews. Responsive: Cards with cert badges.
- **Detail View (/employees/{id})**: Employee "profile" with tabs/accordions.
  - **Header**: Name/Photo, Role Badge, Quick Actions dropdown ("Clock In/Out – for time tracking", "Assign to Job", "Run Payroll", "Renew Cert" – prepopulates forms with employee data).
  - **Core Info Section**: Contact/Address (editable), Hire Date/Status (enum: Active/OnLeave – customizable), Rate (hourly/salary – for calcs), Territory/Zone (dropdown – customizable for companies).
  - **Certs & Training Accordion**: Table (Type/Expiry/Notes – add/edit with alerts for near-expiry; customizable types like "NATE HVAC").
  - **Time Clock & Payroll Accordion**: Current Status (Clocked In/Out with duration), History Table (entries from jobs: Date/Hours/Overtime), Payroll Summary (period totals/computed pay – customizable frequencies like bi-weekly).
  - **Assigned Jobs & Performance Accordion**: Timeline of jobs (with sites/assets/repairs), KPIs (e.g., Completion Rate from jobs, linked to reports).
  - **Expenses & Reimbursements Accordion**: Table (from jobs: Amount/Status/Receipt – add new with job link).
  - **Notes & Documents Accordion**: Quick notes feed (import for performance), docs (e.g., cert PDF – upload/view).
  - **Footer**: "Export Payroll PDF/CSV", related links (e.g., "View Assigned Calendar" filtered by employee).
- **Edit/Create View**: Form mirroring detail, with cert adder (dropdown/search customizable types).

**UX Interactions & Flows**:
- **HR Flow**: Create employee → Add certs (dropdown prepopulates customizable types) → Assign territory (for company routing) → Time clock (mobile swipe in at job site) → Log hours (transfer to payroll).
- **Connectivity Flow**: From detail, "Assign to Job" → Dropdown pulls open jobs (data to calendar for slot check); payroll "Run" aggregates time (transfer from job entries to pay calc).
- **List to Detail**: Filter "Certified for Territorial" → Click employee → Detail with jobs timeline expanded; for multi-site companies, filter assigns by territory.
- **User Journey**: Office onboarding: Create employee with certs → Assign to territorial jobs (prepopulate from company contacts) → Tech mobile clocks in (at site) → Close job (transfer hours to payroll/expenses) → Manager reviews performance (from job/asset history).
- **Efficiency Features**: Prepopulated dropdowns (roles/certs/territories – customizable add/edit/remove); auto-alerts (e.g., "Cert Expires Soon – Renew?"); search employees by cert across app.

**Customizations & Configurability**:
- Admins: Add/edit/remove enums (e.g., Role: Add "Apprentice"; Cert Type: Add "Journeyman Plumber"); customize payroll rules (e.g., overtime thresholds); toggle fields (e.g., add "Vehicle Assigned" for tech trucks). Per-role: Techs view own profile/time (mobile); managers run payroll/full edit.
- Quick Notes: Import to notes (e.g., "Performance" category auto-appends as review entry).

**Edge Cases & Robustness**:
- Multi-Territory: Handle "One Employee, Multiple Territories" (e.g., dropdown multi-select – grouped assigns); "Company Routing" (territorial filters/edits).
- No Certs: Block assignment (e.g., "Can't Schedule – Add Cert?").
- Large Teams: Pagination in lists/history; filter limits (e.g., "My Team Only").
- Permissions: Techs clock/self-view only; managers assign/review. Hidden payroll for techs.
- Offline: Mobile caches time clock (log local, sync to payroll with merge – e.g., "Duplicate Entry – Resolve?").

**Integrations & Automation**:
- Triggers: Cert near-expiry → Alert (e.g., "Block Scheduling Until Renewed"); time over threshold → Overtime expense auto-create.
- External: Payroll API (e.g., QuickBooks for direct deposit); calendar sync for availability; SMS for clock reminders.
- Workflow Ties: Quick links ensure progression (e.g., "From Employee to Job Assign" → Prepopulates dispatcher with cert matches, transferring data). For companies: Territorial auto-assign (e.g., suggest techs for West sites to Jill Dane).

**Mobile Considerations**:
- List as role-filtered cards (swipe to view detail/clock in); detail as vertical scroll with accordions (tap expand time history). Mobile time clock: Clean punch UI with GPS validation, voice for notes. Offline cache prioritizes own profile/jobs (clock local, sync updates payroll/history). Responsive layouts stack groups to lists; embedded in jobs as bottom sheet for quick assignment, ensuring techs can self-manage on-the-go without rework.