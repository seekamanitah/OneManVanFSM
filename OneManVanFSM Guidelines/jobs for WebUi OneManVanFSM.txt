jobs for WebUi OneManVanFSM

### Jobs Page - Exhaustive Description

**Routes**: `/jobs` (list view for browsing, searching, and dispatching all jobs); `/jobs/{id}` (detail view for a specific job, including status updates, work orders, and quick actions); `/jobs/new` or `/jobs/{id}/edit` (create/edit view for setting up or modifying jobs). For contextual integration, embeddable as a component or modal in related pages like Customers (e.g., `/customers/{customerId}/jobs` to list only that customer's or company's jobs) or Calendar/Scheduling (e.g., `/calendar/jobs/{date}` for daily dispatch). This ensures seamless workflow—e.g., while viewing a customer's detail with multi-sites, create a new job without leaving, with data (e.g., site/assets from the customer) transferring automatically to prepopulate the form, reducing steps for the contractor handling emergencies or scheduled maintenance.

**Purpose & Business Context**:
- The Jobs page is envisioned as the dynamic "operations command center" for the entire lifecycle of work—from initial lead/estimate conversion through scheduling, execution, completion, and follow-up—serving as the hub where all app modules converge for real-time action. For a small HVAC contractor, it captures the fast-paced reality: An emergency AC repair call (priority: high, linked to a customer's site with existing asset history) gets quickly scheduled, dispatched to a certified tech, executed with material deductions and time tracking, and closed with auto-invoice generation—all while handling complexities like multi-zone systems (e.g., separate work orders per story) or territorial assignments (e.g., route to the right company contact for East County sites). Presentation emphasizes progression: List views provide dispatch overviews with status timelines (e.g., "Quoted ? Scheduled ? In Progress"), while details offer a "job file" with embedded work orders, material lists, and quick glances at linked sites/assets for on-the-spot decisions.
- HVAC-specific: Prioritizes elements like system type (spider/trunk with CFM/reductions from pasted-text), urgency dropdowns (Emergency/Standard/Scheduled – customizable for seasonal peaks like summer heatwaves), and compliance tracking (e.g., refrigerant handling in work orders). Generic foundation: Adaptable for other trades without app changes—e.g., repurpose "Zones" for "Circuit Groups" in electrical (panels per area) or "Fixture Sets" in plumbing (sinks per bathroom), using customizable fields to adjust workflow steps while maintaining core progression (lead to close). This supports scenarios: A landlord's multi-rental job (e.g., filter changes across estates, batched as sub-tasks) or a company's dispersed sites (e.g., rooftop unit repairs filtered by territorial contact, ensuring notifications route correctly).
- Business value: Promotes user-friendly efficiency by automating data transfer—e.g., convert an estimate to a job (carry over material lists/sites/assets/customer notes), execute with mobile time/material logging (no re-entry), and close to trigger invoice/asset updates (shared data like labor hours flow to payroll). Industry thinking: Contractors operate reactively (e.g., emergency calls) but need oversight (e.g., dispatch views tech availability by certification/location); the page supports this with quick mobile status swipes for techs (clean, work-focused UI) and desktop calendars for office (full access with drag-drop rescheduling). For multi-site customers/companies (e.g., estates with varying assets per rental or chains with territorial divisions), jobs enable "group dispatching" (batch schedule similar repairs across sites, shared material lists), with territorial filtering to assign/notifications correctly (e.g., notify Jill Dane for West site jobs). Overall robustness: Connectivity ensures end-to-end traceability—e.g., a job's materials deduct from inventory, update linked assets' repair history, and log variances for reports, reducing disputes and supporting warranties/compliance in repeat business.

**Data Sources & Interconnections**:
- **Core Entity**: Jobs table (ID PK, CustomerID/CompanyID/SiteID/AssetID polymorphic FKs for linking; Status enum: Lead/Quoted/Approved/Scheduled/EnRoute/OnSite/InProgress/Paused/Completed/Closed/Cancelled – customizable transitions with rules like "Can't Invoice Until Completed"; Priority/Urgency enum from pasted-text; ScheduledDate/Time/EstimatedDuration; SystemType enum: Spider/Trunk – customizable with fields like Plenum Material/CFMs; Notes/WorkOrderChecklist JSON for sub-tasks). One-to-Many with TimeEntries (tech hours), JobMaterials (from lists: Deducted quantities), RepairLogs (appends to assets).
- **Sources**: Prepopulates from Estimates (convert transfers bid data like material lists/system type), Customers/Companies/Sites (ownership/address/access notes – customizable territorial contacts), Assets (linked equipment for repair focus), Employees (assignment by certification/availability – prepopulated dropdowns).
- **Interconnections** (App-Wide Flow for Shared Workflow Progression):
  - **Estimates**: One-to-One (Job from approved EstimateID). Connectivity: Estimate approval → "Convert to Job" transfers all (material lists/sites/assets/customer notes/pricing method – data flow: Bid totals to job estimate, sections to job materials). App flow: From estimate detail, "Create Job" opens jobs form prepopulated; job variances (e.g., extra labor) feed back to estimate reports for bid accuracy.
  - **Sites/Customers/Companies**: Many-to-One (Job SiteID/CustomerID/CompanyID FK). Connectivity: Job create/search filters by site/customer (prepopulates address/access/territorial contact); multi-site jobs (e.g., landlord rentals) batch sub-tasks per site (shared material lists). App flow: Customer detail "New Job" embeds jobs form (data transfer to site/assets); company territorial: Auto-assign contact for notifications/dispatch (e.g., East jobs to John Doe).
  - **Assets**: Many-to-Many (via JobAssets junction or material lists). Connectivity: Job "Link Asset" pulls from site/customer (prepopulates repair needs); execution updates asset history (e.g., "Tune-Up Completed" appends log, extends warranty). App flow: Asset detail "Schedule Job for This" opens jobs form with asset prepopulated (data transfer to work order checklist/material suggestions); multi-assets per job/site (e.g., zone-specific repairs group in sub-tasks).
  - **Material Lists/Inventory/Products**: One-to-One/Many (Job MaterialListID FK). Connectivity: Job create imports list (sections to job materials – data transfer: Quantities for deductions); execution deducts inventory (real-time from list, creates assets if install). App flow: Job embedded material builder (edit list in-place, transfer updates to invoice); products suggest via list (e.g., "Compatible Collar from Template").
  - **Invoices/Expenses/Payments**: One-to-One (Job InvoiceID FK on close). Connectivity: Job completion auto-drafts invoice (transfers materials/labor/totals from list/pricing method, site fees, asset warranties); variances create expenses (e.g., extra "Flu Pipe"). App flow: From job detail, "Generate Invoice" embeds preview (data to lines); payments update job status (e.g., "Paid – Close Job?").
  - **Employees/Time Clock/ServiceAgreements**: Many-to-Many (JobWorkers junction with EmployeeID); agreements auto-create jobs. Connectivity: Assignment by employee certification/location (prepopulated dropdown – customizable like "EPA Certified for Refrigerant"); time entries from job (mobile clock-in at site) transfer to labor calcs/payroll. App flow: Employee detail "Assigned Jobs" filters list (data to time clock); agreements link jobs to recurring lists/sites (transfer due dates).
  - **QuickNotes/Documents/Notifications**: Polymorphic notes/docs per job (import to work orders); notifications from status changes (e.g., "EnRoute" SMS to customer contact). Connectivity: Quick note on site/asset → Imports to job notes (e.g., "Access Code Updated"); docs (e.g., permit PDF) attach from pasted-text sections.
  - **Shared Data Flow**: Estimate conversion (transfer bid/lists/sites) → Job create (prepopulate customer/company/territorial contact/assets) → Schedule/dispatch (assign employee by cert/location) → Execution (mobile: Deduct materials/inventory, update asset history/time entries) → Close (transfer to invoice/expenses, append repair logs) → Reports (e.g., "Job Profitability" from variances). For multi-site: "Batch Job" duplicates for landlord estates (shared data like lists). Robust views: "JobTimelineView" (joins status/history for dashboards); "TerritorialDispatchView" (filters by company contact).

**Layout & Sections** (Desktop Web Focus: Timeline/Board-Style with Embeddables, Responsive for Mobile Card-Stacking):
- **List View (/jobs)**: Kanban board or table (columns/status lanes: Lead/Quoted/Scheduled/InProgress/Completed – draggable to change status; fields: Job #/Customer/Site (clickable), Priority Badge, Scheduled Date/Tech, Est. Duration/Total – sortable/prepopulated filters like "Emergency Only" dropdown customizable). Groupable by customer/company/site for multi-job overviews. Responsive: Cards with status swipes.
- **Detail View (/jobs/{id})**: Job "file" with tabs/accordions.
  - **Header**: Job #/Status (dropdown to update – customizable rules), Priority/Urgency Badge, Quick Actions dropdown ("Update Status/Schedule/Reschedule/Assign Tech/Generate Work Order/Close & Invoice" – prepopulates with job data).
  - **Core Info Section**: Linked Customer/Company/Contact (territorial dropdown if company), Site/Link (address/map/access notes – prepopulated from site), System Type (dropdown with fields like CFM – customizable), Notes/Work Order Checklist (JSON editable as tasks).
  - **Linked Entities Accordion**: "Site/Assets" (embedded summaries with multi-asset grouping); "Material List" (embedded builder/view with transfer buttons).
  - **Timeline & History Section**: Chronological feed (status changes/jobs/repairs/time entries – with tech logs).
  - **Labor & Team Accordion**: Assigned Employees (dropdown by cert/availability – customizable), Time Entries table (hours tracked).
  - **Financials Accordion**: Est. Total (from list/pricing), Linked Invoice/Expenses (preview/generate).
  - **Footer**: "Export Job PDF/CSV" (with timeline), related links (e.g., "View Similar by Customer" filtered).
- **Edit/Create View**: Form with integrations (e.g., "Select from Estimate" dropdown prepopulates – customizable sources).

**UX Interactions & Flows**:
- **Progression Flow**: Create from estimate (prepopulate all) → Assign tech/site (dropdown suggests by location/cert) → Schedule (calendar embed with drag) → Tech mobile: Status swipe "EnRoute" (GPS auto-start), log materials/time (embedded trackers) → Close (auto-invoice prompt).
- **Connectivity Flow**: From detail, "Add Material List" → Embeds builder (transfer updates job est.); "Link Asset" pulls from site (data to repair history).
- **List to Detail**: Filter "InProgress for Territorial Contacts" → Click job → Detail with timeline expanded; for multi-site companies, filter groups by site.
- **User Journey**: Office from customer (landlord with estates) → New job batch for multi-sites (prepopulate shared lists/assets) → Dispatch to tech (territorial filter) → Tech mobile closes (transfer to invoice, update assets).
- **Efficiency Features**: Prepopulated dropdowns (status/priority/system type – customizable add/edit/remove); auto-suggest techs (by cert/site proximity); search integrates job # across app.

**Customizations & Configurability**:
- Admins: Add/edit/remove enums (e.g., Status: Add "OnHold"; Type: Add "Plumbing Inspection"); customize workflow rules (e.g., require site before scheduling); toggle fields (e.g., add "Weather Impact" for HVAC). Per-role: Techs update status/time (mobile-only fields); office assigns/full edit.
- Quick Notes: Import to notes/checklist (e.g., "Task" category auto-adds as work order item).

**Edge Cases & Robustness**:
- Multi-Site/Asset Jobs: Handle "One Job, Multiple Sites" (e.g., batch sub-tasks with shared lists – grouped views); "Territorial Routing" (contact-specific notifications/edits).
- No Data: Prompt "Link Site/Asset Now?" on create.
- Large Jobs: Pagination in timelines/history; collapse accordions.
- Permissions: Techs execute only (status/time/materials); dispatchers schedule/assign. Hidden financials for techs.
- Offline: Mobile caches assigned jobs (status updates local, sync with conflict resolution – e.g., "Duplicate Update – Merge?").

**Integrations & Automation**:
- Triggers: Status "Scheduled" → Notification (SMS to customer/contact/tech); "Completed" → Auto-draft invoice/update asset.
- External: Google Calendar for scheduling sync; Twilio for urgency alerts; Maps for site navigation in mobile work orders.
- Workflow Ties: Quick links ensure progression (e.g., "From Job to Invoice" → Prepopulates with materials/labor/site fees, transferring data). For companies: Territorial auto-assignment (e.g., suggest techs for West sites to Jill Dane).

**Mobile Considerations**:
- List as status-filtered cards (swipe to update status like "InProgress"); detail as vertical scroll with accordions (tap expand timeline). Mobile work order focus: Clean checklist UI with scan for materials, voice for notes, GPS for "EnRoute" auto-start. Offline cache prioritizes tech's jobs (log local, sync updates history/inventory/assets). Responsive layouts stack lanes to lists; embedded forms as bottom sheets for estimate/customer context, ensuring techs can execute jobs hands-free without rework.