settings page for WebUi OneManVanFSM

### Settings Page - Exhaustive Description

**Routes**: `/settings` (main dashboard view for all configuration categories, with tabs or accordions for navigation); sub-routes for focused sections like `/settings/company` (Company Profile), `/settings/users` (Users & Roles), `/settings/customizations` (Customizations & Data Structures), `/settings/integrations` (Integrations & External Connections), `/settings/notifications` (Notifications & Alerts), `/settings/templates` (Templates for Company-Level Defaults), `/settings/mobile` (Mobile & App Preferences), `/settings/data` (Data Management & Exports). For contextual access, embeddable as a modal or side panel in other pages (e.g., `/jobs/{jobId}/settings` for quick role-based customizations during assignment), ensuring admins can tweak without full navigation. This modular routing promotes efficiency—e.g., an office user adjusting a tech's role during job dispatch opens a targeted modal, with changes propagating app-wide without reloads.

**Purpose & Business Context**:
- The Settings page is the app's comprehensive "control panel," empowering admins/owners to tailor the system to their operations without code changes or workarounds—focusing on personalization for efficiency, scalability, and trade adaptability. For a small HVAC contractor, it streamlines setup: E.g., toggle to Plumbing mode (one-click with warning to confirm dropdown changes like "System Type: Spider" to "Pipe Layout: Copper"), set simple notification toggles for overdue invoices, define company-level templates (e.g., default "AC Install Kit" material list), configure mobile offline sync for techs in remote sites, switch visual themes (light/dark for better visibility in bright workshops), and manage data exports/imports (e.g., CSV for bulk product templates to enter offline then import). This depth ensures robustness from the start: No afterthought features breaking workflows; instead, settings propagate logically (e.g., a new "Plumbing Fixture Type" dropdown added here auto-appears in products/assets/jobs/estimates, with warnings for impacts).
- HVAC-specific defaults: Out-of-box prepopulated for HVAC (e.g., cert types like "EPA 608," material categories like "Ductwork"), but one-click trade modes warn and switch to Plumbing (e.g., "Pipe Sizes: 1/2"-2"") or Electrical (e.g., "Wire Gauges: 12-4 AWG")—ensuring generic foundation without rework (data transfers remain intact, like asset specs adapting but keeping core fields). For territorial companies or multi-site landlords, settings allow role-based territorial filters (e.g., "East County Only" for tech views). Presentation emphasizes intuitiveness: Categorized tabs with previews (e.g., "Apply Changes" button shows "This will update 5 dropdowns in Products/Assets"), simple toggles for notifications (on/off per type, no complex rules), a dedicated Templates section for company defaults (separate to avoid cluttering general customizations), mobile/global splits (e.g., "Global: Light Theme; Mobile: GPS Mandatory for Clock-In"), and data management with CSV exports/imports for all app pages (e.g., export product templates as CSV, edit offline in Excel, import to update database—key for initial setup or bulk changes).
- Business value: Promotes user-friendly efficiency by centralizing configurations that flow app-wide—e.g., edit a "Priority: Emergency" dropdown here, and it prepopulates in jobs/estimates/calendar without re-entry; set mobile sync to "Every 30 Min" for techs in spotty coverage areas. Industry thinking: Small contractors need quick adaptability (e.g., one-click trade mode for expanding from HVAC to plumbing jobs, with warnings to avoid data loss); the page supports this with shared data (e.g., templates export to CSV for offline entry of "Electrical Conduit Kits," then import to products/inventory/assets). For territorial operations, settings define contact-specific notifications; for multi-site customers, customize data management to export site-specific asset histories. Overall robustness: Depth prevents breakage—e.g., trade mode changes trigger a confirmation modal ("This will adapt 10 dropdowns—Export current as CSV first?"), simple toggles keep notifications lightweight (e.g., "On" for "Low Inventory Email" without rule builders), Templates separate for company-specific defaults (e.g., "Our Standard HVAC Labor Rate"), mobile settings ensure field techs' clean UI (e.g., "Require Photo for Claims: On"), and CSV exports/imports for all pages (e.g., material lists, products, assets, jobs) allow bulk data entry without database direct access, supporting scalability.

**Data Sources & Interconnections**:
- **Core Entity**: Settings table (ID PK, Category/Key/Value JSON for flexible storage – e.g., "TradeMode: HVAC"; UserID/RoleID FK for per-user/role overrides; LastUpdated/Timestamp for audits). Templates as child table (ID PK, Name/Type: MaterialList/Product/Job – customizable; Data JSON for defaults like "Standard AC Kit: Flex Duct 6": 2 Boxes").
- **Sources**: App-wide defaults from initial setup (HVAC-focused, with one-click modes for Plumbing/Electrical—e.g., HVAC: "System Type: Spider/Trunk"; Plumbing: "Pipe Type: Copper/PVC"; Electrical: "Circuit Type: Single/Three-Phase"); user/role data from Employees; integrations from external APIs.
- **Interconnections** (App-Wide Flow for Shared Configurations):
  - **All Pages/Entities**: Settings propagate globally (e.g., trade mode change warns then updates dropdowns in products/assets/material lists/jobs/estimates/service agreements/history—data flow: "System Type" options adapt, existing data migrates with preview). App flow: Edit "Priority Dropdown" here → Prepopulates in jobs/estimates/calendar without restart.
  - **Users/Roles/Employees**: Settings link to Employees (role definitions/permissions matrix). Connectivity: Role changes (e.g., add "Plumber Tech" with cert requirements) transfer to job assignments/calendar (filter techs accordingly).
  - **Templates**: Separate section ties to products/material lists/jobs (e.g., export "Default HVAC Install List" as CSV, edit offline, import to update templates—data flow to new bids/jobs).
  - **Notifications/Financials**: Simple toggles link to invoices/expenses/payments (e.g., "On" for "Overdue Invoice Email" – no rules, but customizable recipients like territorial contacts).
  - **Mobile/App Preferences**: Mobile settings (e.g., sync frequency) transfer to app behavior; theme (light/dark) applies globally/per-user.
  - **Data Management**: CSV exports/imports for templates across pages (e.g., export products CSV with columns like Name/Category/Specs, edit, import to database—ties to inventory/assets for updates).
  - **Shared Data Flow**: Trade mode toggle (one-click with warning modal: "Switching to Plumbing will update 15 dropdowns—Export current as CSV? Confirm?") → Propagates to entities (e.g., products category "Ductwork" to "Piping"); template import (from CSV) → Updates defaults (transfer to new material lists/jobs); notification toggle "On" → Activates in financials/jobs (e.g., overdue from invoices alerts via email/SMS). For territorial companies, settings define contact-specific toggles. Robust views: "SettingsAuditView" (logs changes for compliance).

**Layout & Sections** (Desktop Web Focus: Tabbed Control Panel with Previews, Responsive for Mobile Accordion-Stacking):
- **Main Dashboard View (/settings)**: Tabbed interface (horizontal on desktop; vertical accordions on mobile) with search bar (e.g., "Search: Trade Mode") and "Apply Changes" button (preview impacts first). Left sidebar: Quick nav to tabs; top: Global save/undo.
- **Company Profile & Branding Tab**: Form (name/logo/address/tax ID – preview invoice PDF with changes); advanced: Custom fields (add "Business Hours").
- **Users, Roles & Permissions Tab**: Users table (add/edit/remove/invite – with role dropdown); roles matrix (toggles like "Techs: View Own Jobs Only"); territorial/zone multi-select (customizable dropdowns).
- **Customizations & Data Structures Tab**: Enums/dropdowns list (searchable, add/edit/remove with previews – e.g., "System Type: Add 'Ductless'"); custom fields editor (per entity: Add "Plumbing Flow Rate" to assets/products); trade modes toggle (one-click buttons: HVAC/Plumbing/Electrical – warning modal: "This adapts dropdowns—Export CSV? Changes: X dropdowns updated. Confirm?").
- **Integrations & External Connections Tab**: Toggle/list (e.g., QuickBooks: API key/sync settings; Stripe: Card methods – customizable).
- **Notifications & Alerts Tab**: Simple toggles (e.g., "Low Inventory Email: On/Off"; "Cert Expiry SMS: On/Off" – no rules, but customizable per role/recipient like "Techs Only").
- **Templates Tab** (Separate for Company-Level Defaults): List of template types (Material Lists/Products/Jobs/Estimates – add/edit with forms; export/import CSV buttons – e.g., "Export Material List Template: Columns Name/Section/Item/Quantity/DefaultCost").
- **Mobile & App Preferences Tab**: Global (theme: Light/Dark toggle – preview; default views: Calendar/Jobs); mobile-specific (offline sync: Every 15/30/60 Min; GPS for clock-in: Required/Optional; photo compression: High/Low).
- **Data Management & Exports Tab**: Export/import tools (CSV for templates across pages – e.g., "Export Products: Download CSV with Name/Category/Specs"; import wizard with validation/mapping); backups (manual/scheduled – download ZIP of database extracts); data retention (e.g., archive old jobs/history); GDPR delete (per customer).
- **Advanced / System Tab** (Collapsible): Audit logs table (filterable changes); reset defaults (per trade mode); version/support.

**UX Interactions & Flows**:
- **Configuration Flow**: Search "Trade Mode" → Toggle to Plumbing (warning: "Updates 10 dropdowns—Export CSV first?") → Preview/apply (changes reflect in products/assets immediately).
- **Connectivity Flow**: Edit role permissions (e.g., "Techs: Mobile Clock-In Only") → Propagates to jobs/calendar (tech views limited); template import (upload CSV) → Validates/maps (e.g., "New Column 'Flow Rate' Added to Products").
- **Main to Tab-Detail**: Filter search "Notifications" → Jumps to tab with toggles expanded.
- **User Journey**: Owner setup: Company profile (logo for PDFs) → Customizations (add "Plumbing Type" dropdown) → Trade mode (switch to Plumbing with warning/export) → Templates (import CSV for pipe kits) → Integrations (QuickBooks sync) → Notifications (toggle overdue emails) → Mobile (set dark theme/sync) → Data (export backups).
- **Efficiency Features**: Prepopulated defaults (e.g., HVAC dropdowns load on app start – customizable); previews (e.g., "See Changes in Sample Product"); search across all settings.

**Customizations & Configurability** (Meta-Layer for the Settings Page Itself):
- Admins can toggle tabs visibility (e.g., hide Advanced for managers); customize search (add keywords); per-user defaults (e.g., preferred theme).

**Edge Cases & Robustness**:
- Trade Mode Switches: Warning lists impacts (e.g., "10 Existing Assets Affected— Migrate Data?"); rollback button if issues.
- CSV Import/Export: Validation (e.g., "Invalid Column—Map to Existing?"); handle large files (chunked processing).
- No Access: Role-based lock (e.g., techs redirected); empty states (e.g., "No Users—Add First?").
- Large Configs: Pagination in lists (e.g., long dropdown editors); auto-save drafts.
- Offline: Not critical (settings mostly online), but cache user prefs (e.g., theme) for mobile.

**Integrations & Automation**:
- Triggers: Changes → Alert (e.g., "Trade Mode Updated—Review Products?"); import success → Notification (e.g., "Templates Imported—Ready for Use").
- External: Backup to cloud (e.g., Google Drive integration in Data tab); API for custom scripts (if advanced).
- Workflow Ties: Quick links in settings (e.g., "Preview in Products" from Customizations tab – opens sample with new dropdowns).

**Mobile Considerations**:
- Tabs as swipeable or bottom nav (e.g., "Company" first for quick profile tweaks); sections as vertical accordions (tap expand). Mobile-specific tab prominent; CSV export/import via file picker (handle large files with progress). Offline cache for personal prefs (e.g., theme/sync—apply local, sync on connect). Responsive layouts stack tabs to lists; ensure touch-friendly (large toggles/dropdowns), so techs can view limited settings (e.g., their prefs) without rework.